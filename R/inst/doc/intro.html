<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Mengyao Chen" />


<title>Nonparametric kernel estimation</title>

<script>$(document).ready(function(){
    if (typeof $('[data-toggle="tooltip"]').tooltip === 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }
    if ($('[data-toggle="popover"]').popover === 'function') {
        $('[data-toggle="popover"]').popover();
    }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Nonparametric kernel estimation</h1>
<h4 class="author">Mengyao Chen</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p><strong>SC19076</strong> is a simple R package developed to compare the performance ofTwo methods of nonparametric kernel estimation through the R package ) for the ‘Statistical Computing’ course. Two functions are considered, namely, <em>GMSMOOTH</em> (generate kernel estimate by using GM estimate) and <em>NWSMOOTH</em> (generate kernel estimate by using NW estimate). For each function, both R and Rcpp versions are produced. Namely <em>GMSMOOTH</em> and <em>NWSMOOTH</em> for R.</p>
<p>The R package ‘microbenchmark’ can be used to benchmark the above R and C++ functions.</p>
</div>
<div id="benchmarking-gmsmooth-and-nwsmooth" class="section level2">
<h2>Benchmarking <em>GMSMOOTH</em> and <em>NWSMOOTH</em></h2>
<p>The source R code for <em>GMSMOOTH</em> is as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">GMSMOOTH &lt;-<span class="st"> </span><span class="cf">function</span>(y, x, h) {</a>
<a class="sourceLine" id="cb1-2" title="2">  n &lt;-<span class="st"> </span><span class="kw">length</span>(y)</a>
<a class="sourceLine" id="cb1-3" title="3">  s &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="ot">Inf</span>, <span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>(x[<span class="op">-</span>n] <span class="op">+</span><span class="st"> </span>x[<span class="op">-</span><span class="dv">1</span>]), <span class="ot">Inf</span>) </a>
<a class="sourceLine" id="cb1-4" title="4">  s.hat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n) </a>
<a class="sourceLine" id="cb1-5" title="5">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb1-6" title="6">    fx.hat &lt;-<span class="st"> </span><span class="cf">function</span>(z, h, x) { </a>
<a class="sourceLine" id="cb1-7" title="7">      <span class="kw">dnorm</span>((x <span class="op">-</span><span class="st"> </span>z)<span class="op">/</span>h)<span class="op">/</span>h</a>
<a class="sourceLine" id="cb1-8" title="8">    } </a>
<a class="sourceLine" id="cb1-9" title="9">    a &lt;-<span class="st"> </span>y[i] <span class="op">*</span><span class="st"> </span><span class="kw">integrate</span>(fx.hat, s[i], s[i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>], <span class="dt">h =</span></a>
<a class="sourceLine" id="cb1-10" title="10">                            h, <span class="dt">x =</span> x[i])<span class="op">$</span>value </a>
<a class="sourceLine" id="cb1-11" title="11">    s.hat[i] &lt;-<span class="st"> </span><span class="kw">sum</span>(a)</a>
<a class="sourceLine" id="cb1-12" title="12">  }</a>
<a class="sourceLine" id="cb1-13" title="13">  <span class="kw">return</span>(s.hat)</a>
<a class="sourceLine" id="cb1-14" title="14">} </a></code></pre></div>
<p>The exception to the kernel estimate is the NW estimate, where we can define the NW function is follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">NWSMOOTH &lt;-<span class="st"> </span><span class="cf">function</span>(h,y,x) {</a>
<a class="sourceLine" id="cb2-2" title="2">  n &lt;-<span class="st"> </span><span class="kw">length</span>(y) </a>
<a class="sourceLine" id="cb2-3" title="3">  s.hat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n) </a>
<a class="sourceLine" id="cb2-4" title="4">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb2-5" title="5">    a &lt;-<span class="st"> </span><span class="kw">fx.hat</span>(x[i], h) </a>
<a class="sourceLine" id="cb2-6" title="6">    s.hat[i] &lt;-<span class="st"> </span><span class="kw">sum</span>(y <span class="op">*</span><span class="st"> </span>a<span class="op">/</span><span class="kw">sum</span>(a))</a>
<a class="sourceLine" id="cb2-7" title="7">  } </a>
<a class="sourceLine" id="cb2-8" title="8">  <span class="kw">return</span>(s.hat)</a>
<a class="sourceLine" id="cb2-9" title="9">} </a></code></pre></div>
<p>In order to compare the effect of GM kernel NW method on kernel estimation in non-parametric kernel estimation, set the bandwidth and draw the kernel estimation under GM kernel NW algorithm, and compare the kernel true distribution.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">library</span>(SC19076)</a></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;SC19076&#39;</code></pre>
<pre><code>## The following object is masked _by_ &#39;.GlobalEnv&#39;:
## 
##     NWSMOOTH</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dt">length =</span> <span class="dv">40</span>)</a>
<a class="sourceLine" id="cb6-2" title="2">y &lt;-<span class="st"> </span><span class="dv">5</span> <span class="op">*</span><span class="st"> </span>x <span class="op">*</span><span class="st"> </span><span class="kw">cos</span>(<span class="dv">5</span> <span class="op">*</span><span class="st"> </span>pi <span class="op">*</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb6-3" title="3">h &lt;-<span class="st"> </span><span class="fl">0.055</span> </a>
<a class="sourceLine" id="cb6-4" title="4">fx.hat &lt;-<span class="st"> </span><span class="cf">function</span>(z, h) { </a>
<a class="sourceLine" id="cb6-5" title="5">  <span class="kw">dnorm</span>((z <span class="op">-</span><span class="st"> </span>x)<span class="op">/</span>h)<span class="op">/</span>h</a>
<a class="sourceLine" id="cb6-6" title="6">}</a>
<a class="sourceLine" id="cb6-7" title="7">NWsmooth.val &lt;-<span class="st"> </span><span class="kw">NWSMOOTH</span>(h, y, x)</a>
<a class="sourceLine" id="cb6-8" title="8">GMsmooth.val &lt;-<span class="st"> </span><span class="kw">GMSMOOTH</span>(y, x, h)</a>
<a class="sourceLine" id="cb6-9" title="9"><span class="kw">plot</span>(x, y, <span class="dt">xlab =</span> <span class="st">&quot;Predictor&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Response&quot;</span>, <span class="dt">col =</span> <span class="dv">1</span>) </a>
<a class="sourceLine" id="cb6-10" title="10">f &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="dv">5</span> <span class="op">*</span><span class="st"> </span>x <span class="op">*</span><span class="st"> </span><span class="kw">cos</span>(<span class="dv">5</span> <span class="op">*</span><span class="st"> </span>pi <span class="op">*</span><span class="st"> </span>x) </a>
<a class="sourceLine" id="cb6-11" title="11"><span class="kw">curve</span>(f, <span class="dv">-1</span>, <span class="dv">1</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">15.5</span>, <span class="fl">15.5</span>), <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">add =</span> T, <span class="dt">col =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb6-12" title="12"><span class="kw">lines</span>(x, NWsmooth.val, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb6-13" title="13"><span class="kw">lines</span>(x, GMsmooth.val, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb6-14" title="14">letters &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;orignal model&quot;</span>, <span class="st">&quot;NW method&quot;</span>, <span class="st">&quot;GM method&quot;</span>) </a>
<a class="sourceLine" id="cb6-15" title="15"><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="dt">legend =</span> letters, <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA51BMVEUAAAAAADoAAGYAOjoAOpAAZrYAzQA6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kNtmAABmADpmAGZmOjpmOmZmOpBmZjpmZmZmZpBmZrZmkJBmkLZmkNtmtrZmtttmtv+QOgCQOjqQOmaQZjqQZmaQZpCQkDqQkGaQtpCQtraQttuQ29uQ2/+2ZgC2Zjq2Zma2ZpC2kDq2kGa2tma2tpC2tra22/+2///bkDrbkGbbkJDbtmbbtpDbtrbb25Db29vb2//b/7bb/9vb////AAD/tmb/25D/29v//7b//9v////uVHxOAAAACXBIWXMAAA7DAAAOwwHHb6hkAAANXElEQVR4nO2dDXfbthWGkS2ml9mZLXfzmnnNam+J562V7dXdanlZ6y4iNYn///eM+CAJgABefoASbd/3HCciCV6Aj4CLCxCkWE4Kiu26AFMXAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAUUGxJ6MdgVIUYprdQTtElD5N2ntEBAbw2507RYQI0ABcwQImeN4ps5np4CoF2thbvKECBAQAQLaNaDJExoV0Gr/HJqbDCBPjzEKoPVJPdb7xX3Y3FQA+cY949SgjM34f0+oBnnHPSM1sfXJ66ULkGMWYRqEvGH9aD7o+tW8VQ2aECCnFxrPSS/YDAJK+xgeR8wzLhyxF1vt//IJAfJUoFG7+c0Fw4AmMx7zdGM7DhRTlrNp1CHf6LkPoCLMeb28ng0vT56kk5kTEhXIUZYegLJX88Xr5fpkECEFSNbriQBirmbWHdDmYpYXgPKFJ0buZA4A2p6DqgsyGND65FwAymIACs8qbvG2RznDGbEGXfNYeVCBcu6EApVEHtoOIemjHbW5tw9a+LvwDuaUl3amYM4qP5JYlafzQGsLQmKwXowkhhdIRkKeBIrQNgE5Mtv5hFnqtsw0RNuQd4Zzx4CSIKCt9WJ1PjEA8QhowdggH12ZSzxFKHuUrQASzjl1jwx7ACq6r9X+Xn69N6xMoAzMO0MTXTKbaIB4HJQVXVicOMjrhMpqvwVCAlDK3D1GP0DXBZwokbTfCfn7leiKDKhoW3xCdX0SpYltD5DoEn13LphoXy5CvZx0EQRtLnrxca1sS31eulsBUc6q0XocHtPSOcvRJoOYagfIH2f3yC8QmTPnR+d2KIeYqswF+nlZ7ePEQnKY1WLiOQKgzUXwlmBHc4mnENJnFtUrTl8PAKXlp0Z17uOkB5Fx5esGpNxmpAGrNOOJPKMCGjiV6MjX6YQUIJbGAhToxfJU+2Sl6BcHDZfexFyAqk4sGiArX0NRAfXs4H3meCQUACRqP+qa22WYWhlrx1JRjiSJAkiMMwYLNbF6V2BZSgdColP03acU+xJHybrkoTWx8MKWjuZyH6DUldQ6v20tKtOl7rBdr84RalAUhcokj4tq7wsC5PipbQjANN5PD1BRKBegtK7zafOwimratTMmbATGLmndwBrVuQ+g1X68OWlfIVhaFTl3AVJjq1ZVCAHSvowogOTysTh3NVShHIfLfYkbEKuGnq0A1V2h4z6Tbj8ZDojfF+NaxLgv5i6U4XwTRxsTx1OuVl6aiQrEHZqMKaxzDPOJlVn/QDHWjKLzW2NapW8CqoYMbR8KrNMkjsBTb2GNNjaFGmQ3Iv4dG567WevratC4XhcwVnlh5qhCLDG2zPMn4YMcgPSAJXEBSpmKAXRCzN2xpUwLAx2AjI3EHNCO1IvBKREj36RRYACIlUOCJKk/q56tYd1sNDaARoeamADHiYMWTI34M+YZ+pvmEuug2cIaTqg4nmhMcuGrZa/mqkJpo4qY1vTcjR6vWdCAugAq3VTu91TWl2j5DfsiGoDqa+a9k6pEjIPLxZ9xcqOPtDYtQMlgQGI0FnLR2oyI1de5H0dnzBoj2VXGrmH6YWFMgkn5WIvl9k0B62wbt+0Ardqbt5TmpIX7WQScUMcaxMSXGCqVFZzYvNTAQ47NWMpkrSqP2k3KOp3Z/brVIp3Fd0jr5mX1CC2gqrq4Vj6oCcj+zs1Cu3o15XvEv6ke6zimWY0qxRJ7hN/oUtupDhS/kFUnGCiWcyJeiBYgc6KqwYcZUBplZtpfLr12nsswINFjpjJ5qp+a2MetsMhzAQ01alDEQJFZVYTZXyIzqo1j6GbMN7PynLy8+hAgx3HLa7eTHihyQlEDRWZ9a83AUQ8GnaN7+wSV3HlXRMvNCchf0HCmUi2elutirtzUCDnGi6zsrHmXjgdfsnSp6tUaF6nlljjmvFMzbUt1ChQ7mzMDa9fgNJWj8UYgF8rAFVJYuSUO3unAJhZFDUA6FNf0RloldFQJl33VzlxJ9UbqmBA3Rvc9AEVdgldtponvmNpV3rVx+BS3fcZcfbw4qM2xOgCZcSjMqpEw+hK83ADknKKuq1jLiXrVk7kTq/tg8kZYdECxl+DZhfIBqj61u9XDypSojTkA6ZFYP0DxluBV21rDd89Bl8faltgzN1Tm5i1JbvapfZpYzCV4+nblFnwnpB34yJM8tQ08dc08n8N5VZ+GLMHz5ltue9YyqASeO6OdM69dkzOzgU46ijyAeCUafc2iHj37ACVa4tZWY6oJyL+GSSYIre/pnHcZmbtr5FBA8Z5Z1bfDixWqlfctQqC46n5FEZ9Z1bfRao7QGsOg6WHqDijqM6v6dmj9RRkZPwVAcZ9Z1bYVIL+PbjnM2DWgQc+s+pt2tcMzm8G0v5YljaLePijqhJm2I3WPL/PQsxbA9CD17MXirg/SdsgbQIOucfeARslXDiWeFaB/x3TSFaCWjqaLaYce5v6tQpvLZbm7M6CFmoneXETtxdRYK28739PFtKHNz8U//PI3/J/H4v9HBegx/99SHt98vlwW//cCxG+r8v4rY75bgp3MWTvEQuahw4nSmzkD4uzo+6PvfvPNwzw7u3vz12Lj0/E/j+4KEouju8O/n97z45/O7t5+Ovr+rA8gMYgvIqHFSE663YR8R9O6bu/zm3fzonLc3m/+cjXfXH7+8e4tB/QwX5+J3fnN4f3m8sNX//rzux6AxABjc3HAhj6O0Mw32nC9G6AP33y+dAD6+O3jj3e9APHo53pY86rNGXtiPeUctLA6/XD8wAGtTr98wwHdffXx8KoGxI+vTq/e/nR6ddyniSlAw+5o1Ob0HaxtpNzZtFP/+UF2VXGs5Rag4c/7NMdiis62AG0+/uGHeNbyLQAyJvpimt6SNQLUKmG3lQutXlVa7Yj1tqCgiazoXm6/vSz6qvM8M0u3+bmOqGv/NMpYrMvrkus9sV7IpUyIJxW0/6V4oHszL7qsL8/yWzOAzs4f5o91KO0taDjbdurwumRr3+g16E+/X97Ms/Ps60sBoQ6gzxaz73gYrULpcQF5X5ccNBfprkUY0Hk2uylCnof5w9/e51X4c1MEzldFDSoiRBUpjgyow+uSjZ0x3qgEAOU3B/Oij19m73jhygC6CJw/bRdQq9clW/viuGkEiK9CXczy9W+5d6wC6Kvj7O3HAtBPKpQeH5DzdcnB202RXgs4mQkzKPy6ZNe+FwXIP6b1+KAnHyh2UmdAW+jF8tXvDs6W2dEyX5+aEZo7TpwYoCgKT3ccL4toOjuc59mhAATixGcMKEnMP6mF8IrZH9/n/yg6dBwnPmNAbhXN6ObXe0Uc/d/3t/ct4sRRAW3RXGvTfLC6Piua09VcA+SPE18coPzh8N3B19n56u1SA+SPE18eoNGsEaCtZkuAtmxuPNMEKJY1ArTVbOn35uMabZluJ8l6Jo9rlADFSUeAppisZ/K4RglQnHQEaIrJeiaPa5QAxUn3/AA9JxEgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBBQbECrN9UKuGzgU/jG+X5j+hH5sITnmZx+RYsMaH1SPcTBH5/IBhAyzvcbM46sfuXPr2fR4gLK6qdc5Dq0/k9YGef7jZlHAm9m6Vu0qIAyNquKKJfj93/ZjnG+35h5ZOG96N5Fi+2D6lKI2t7/ZTvG+X5j5pHrA+Z/8L9f0UYDJNt4fydknO83ZhyRDyP53jLWr2jPCpBVhChFe15NTO7yPIy00ya2KNv+bp203OXp6yfmpHfRzcsrh01sd928XoqdBIrioqGT3mGgqEoh3wi7GDjUUOcjY0ay66Kp+x5m61c0GqwCESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgQ0CUDX8oUsnuUW2au5fOd+uT3oF9C6ahqAxA96yAV0TVnrMAxY42tCgHwrUghQCWi1f77+4oovZ64WrPF1KldlE+N791b7jMmfseIpVPoRNSVAwtnwjwvxXvji+vnPl2dMAeJ71ycz8Zn/8Dv/3W5fs4ynCQGSFzxTv1XF1zvJJXXXElD5E7n8s1xEJ4AO/r0moGkAkr3YTDkY6XQKOnLRnOrFysWr9WfeJEd3SNMAVLUT1X6kzhcGILV4tQZUfHqhgKqlm1SDpCxA1VWrBc1BH/QSAYn+SvzECf9g9GKbiz0Bqu7FXiQgEfGI5tWMg7hL1+KglwFoyiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEND/AQqw5caEOQVWAAAAAElFTkSuQmCC" /><!-- --></p>
<p>As you can see from the figure, the variance of the NW estimate seems to be smaller, and it is, with the incremental variance of the GM estimate being about 1.5 times that of the NW estimate.But GM reckons it has solved some of the calculation’s problems.</p>
<p>Then, we will show the influence of the choice of different window widths on the estimation</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dt">length =</span> <span class="dv">40</span>) </a>
<a class="sourceLine" id="cb7-2" title="2">y &lt;-<span class="st"> </span><span class="dv">5</span> <span class="op">*</span><span class="st"> </span>x <span class="op">*</span><span class="st"> </span><span class="kw">cos</span>(<span class="dv">5</span> <span class="op">*</span><span class="st"> </span>pi <span class="op">*</span><span class="st"> </span>x) </a>
<a class="sourceLine" id="cb7-3" title="3">fx.hat &lt;-<span class="st"> </span><span class="cf">function</span>(z, h) { </a>
<a class="sourceLine" id="cb7-4" title="4">  <span class="kw">dnorm</span>((z <span class="op">-</span><span class="st"> </span>x)<span class="op">/</span>h)<span class="op">/</span>h</a>
<a class="sourceLine" id="cb7-5" title="5">}</a>
<a class="sourceLine" id="cb7-6" title="6">NWSMOOTH &lt;-<span class="st"> </span><span class="cf">function</span>(h, y, x) { </a>
<a class="sourceLine" id="cb7-7" title="7">  n &lt;-<span class="st"> </span><span class="kw">length</span>(y) </a>
<a class="sourceLine" id="cb7-8" title="8">  s.hat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</a>
<a class="sourceLine" id="cb7-9" title="9">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) { </a>
<a class="sourceLine" id="cb7-10" title="10">    a &lt;-<span class="st"> </span><span class="kw">fx.hat</span>(x[i], h) </a>
<a class="sourceLine" id="cb7-11" title="11">    s.hat[i] &lt;-<span class="st"> </span><span class="kw">sum</span>(y <span class="op">*</span><span class="st"> </span>a<span class="op">/</span><span class="kw">sum</span>(a))</a>
<a class="sourceLine" id="cb7-12" title="12">  } </a>
<a class="sourceLine" id="cb7-13" title="13">  <span class="kw">return</span>(s.hat)</a>
<a class="sourceLine" id="cb7-14" title="14">}</a>
<a class="sourceLine" id="cb7-15" title="15">h &lt;-<span class="st"> </span><span class="fl">0.025</span> </a>
<a class="sourceLine" id="cb7-16" title="16">NWsmooth.val0 &lt;-<span class="st"> </span><span class="kw">NWSMOOTH</span>(h, y, x) </a>
<a class="sourceLine" id="cb7-17" title="17">h &lt;-<span class="st"> </span><span class="fl">0.05</span> </a>
<a class="sourceLine" id="cb7-18" title="18">NWsmooth.val1 &lt;-<span class="st"> </span><span class="kw">NWSMOOTH</span>(h, y, x) </a>
<a class="sourceLine" id="cb7-19" title="19">h &lt;-<span class="st"> </span><span class="fl">0.1</span> </a>
<a class="sourceLine" id="cb7-20" title="20">NWsmooth.val2 &lt;-<span class="st"> </span><span class="kw">NWSMOOTH</span>(h, y, x)</a>
<a class="sourceLine" id="cb7-21" title="21">h &lt;-<span class="st"> </span><span class="fl">0.2</span> </a>
<a class="sourceLine" id="cb7-22" title="22">NWsmooth.val3 &lt;-<span class="st"> </span><span class="kw">NWSMOOTH</span>(h, y, x) </a>
<a class="sourceLine" id="cb7-23" title="23">h &lt;-<span class="st"> </span><span class="fl">0.3</span></a>
<a class="sourceLine" id="cb7-24" title="24">NWsmooth.val4 &lt;-<span class="st"> </span><span class="kw">NWSMOOTH</span>(h, y, x)</a>
<a class="sourceLine" id="cb7-25" title="25"><span class="kw">plot</span>(x, y, <span class="dt">xlab =</span> <span class="st">&quot;Predictor&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Response&quot;</span>, <span class="dt">col =</span> <span class="dv">1</span>) </a>
<a class="sourceLine" id="cb7-26" title="26">f &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="dv">5</span> <span class="op">*</span><span class="st"> </span>x <span class="op">*</span><span class="st"> </span><span class="kw">cos</span>(<span class="dv">5</span> <span class="op">*</span><span class="st"> </span>pi <span class="op">*</span><span class="st"> </span>x) </a>
<a class="sourceLine" id="cb7-27" title="27"><span class="kw">curve</span>(f, <span class="dv">-1</span>, <span class="dv">1</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">15.5</span>, <span class="fl">15.5</span>), <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">add =</span> T, <span class="dt">col =</span> <span class="dv">1</span>) </a>
<a class="sourceLine" id="cb7-28" title="28"><span class="kw">lines</span>(x, NWsmooth.val0, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="dv">2</span>) </a>
<a class="sourceLine" id="cb7-29" title="29"><span class="kw">lines</span>(x, NWsmooth.val1, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="dv">3</span>) </a>
<a class="sourceLine" id="cb7-30" title="30"><span class="kw">lines</span>(x, NWsmooth.val2, <span class="dt">lty =</span> <span class="dv">4</span>, <span class="dt">col =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb7-31" title="31"><span class="kw">lines</span>(x, NWsmooth.val3, <span class="dt">lty =</span> <span class="dv">5</span>, <span class="dt">col =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb7-32" title="32"><span class="kw">lines</span>(x, NWsmooth.val4, <span class="dt">lty =</span> <span class="dv">6</span>, <span class="dt">col =</span> <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb7-33" title="33">letters &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;orignal model&quot;</span>, <span class="st">&quot;h=0.025&quot;</span>, <span class="st">&quot;h=0.05&quot;</span>,</a>
<a class="sourceLine" id="cb7-34" title="34"><span class="st">&quot;h=0.1&quot;</span>, <span class="st">&quot;h=0.2&quot;</span>, <span class="st">&quot;h=0.3&quot;</span>) </a>
<a class="sourceLine" id="cb7-35" title="35"><span class="kw">legend</span>(<span class="st">&quot;bottom&quot;</span>, <span class="dt">legend =</span> letters, <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA9lBMVEUAAAAAADoAAGYAAP8AOjoAOpAAZrYAzQAA//86AAA6ADo6AGY6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtmAABmADpmOjpmOmZmOpBmZjpmZmZmZpBmZrZmkLZmkNtmtttmtv+QOgCQOjqQOmaQZjqQZmaQZpCQkDqQkGaQkJCQtraQttuQtv+Q29uQ2/+2ZgC2Zjq2Zma2ZpC2kDq2kGa2tma2tpC2tra225C227a22/+2/7a2///bkDrbkGbbkJDbtmbbtpDbtrbb25Db27bb29vb2//b/9vb////AAD/AP//tmb/25D/27b/29v//7b//9v///9Us6OnAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAN3klEQVR4nO2dC2PbthWFkWkJ46VOnNmdO+cxO7Ezb+3kdHWazbPStKkX01In8v//mREPkgAJ8JAgKDL2PW0sPqBL6BNwcQECFEtJjWJjZ2DqIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERIKDAgNgXo7EAKUphrQ6gMQHl/yatEQGxIewG17iAGAFqMEeAkDmWxtP30uO2YvHk+YwLKI0nX8NGBpROvwgRIKCRAd3xVmy1dQjNTQaQo98zCKD1XtnX+91ls7mpAHL1e4YpQUu2y19alKCpOCFnv2egKrbeu39tA1QZRYgm09A7w/rBfNDZvTkuQdMCZPVCwznpBdtt46QnU8eY/bsasBVbbf3+CwLE+z0bBpQmRwwBiqYzqsjs1X3kQDFiKZuGF2KiZ1j/tnwAZWHO/euz3b75US8TGRPKXJCo7tW8eABa3psv7l+v93oRKgHF0yhCwkdbosXugJKj3TQDlC4cMXIncyxqBLQ5B8ULUCBA671DAWgZAhCPhNwQNnjbQwKy1Hf/EnTGY2X/DJU5A+VnM4Q4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" /><!-- --></p>
<p>It can be seen that the larger the window width, the smoother the estimation, the larger the error, the smaller the window width, the less smooth the estimation, but the goodness of fit has been improved, but it is also easy to overfit.</p>
</div>
<div id="homework-1" class="section level2">
<h2>HomeWork 1</h2>
</div>
<div id="text" class="section level2">
<h2>Text</h2>
<p>I am very happy to learn the course of statistical calculation, which in my opinion is a very practical course.It mainly use R in class. Learning R is very interesting. I hope I can not only learn the course but also have fun in the future study.</p>
<p>The homework for the first class is to use Markdown to write texts,figures and tables. This is the demonstration result of my homework.</p>
</div>
<div id="tables" class="section level2">
<h2>Tables</h2>
<p>Here is a table:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">data</span>(occupationalStatus)</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw">head</span>(occupationalStatus)</a></code></pre></div>
<pre><code>##       destination
## origin   1   2   3   4   5   6   7   8
##      1  50  19  26   8   7  11   6   2
##      2  16  40  34  18  11  20   8   3
##      3  12  35  65  66  35  88  23  21
##      4  11  20  58 110  40 183  64  32
##      5   2   8  12  23  25  46  28  12
##      6  12  28 102 162  90 554 230 177</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">summary</span>(occupationalStatus)</a></code></pre></div>
<pre><code>## Number of cases in table: 3498 
## Number of factors: 2 
## Test for independence of all factors:
##  Chisq = 1416, df = 49, p-value = 2.519e-264
##  Chi-squared approximation may be incorrect</code></pre>
</div>
<div id="including-plots" class="section level2">
<h2>Including Plots</h2>
<p>Here is a figure:</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="homework-2" class="section level2">
<h2>Homework 2</h2>
</div>
<div id="question-1" class="section level2">
<h2>Question 1</h2>
<p>The Rayleigh density is <span class="math inline">\(f(x)=\frac{x}{\sigma^{2}} e^{-x^{2} /\left(2 \sigma^{2}\right)}, \quad x \geq 0, \sigma&gt;0\)</span> Develop an algorithm to generate random samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution. Generate Rayleigh(<span class="math inline">\(\sigma\)</span>) samples for several choices of <span class="math inline">\(\sigma&gt;0\)</span>and check that the mode of the generated samples is close to the theoretical mode <span class="math inline">\(\sigma&gt;0\)</span> (check the histogram).</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer 1</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb12-2" title="2">n&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb12-3" title="3">u&lt;-<span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb12-4" title="4"></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="co">### several choices of σ</span></a>
<a class="sourceLine" id="cb12-6" title="6">sigma=<span class="kw">c</span>(<span class="fl">0.3</span>,<span class="fl">0.5</span>,<span class="fl">0.7</span>,<span class="fl">0.9</span>)</a>
<a class="sourceLine" id="cb12-7" title="7"><span class="cf">for</span> (i <span class="cf">in</span> sigma){</a>
<a class="sourceLine" id="cb12-8" title="8">x=<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>(i)<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">logb</span>(<span class="dv">1</span><span class="op">-</span>u))</a>
<a class="sourceLine" id="cb12-9" title="9"></a>
<a class="sourceLine" id="cb12-10" title="10"><span class="co">### Generate Rayleigh samples </span></a>
<a class="sourceLine" id="cb12-11" title="11"><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb12-12" title="12">     <span class="dt">main=</span><span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>(x<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>e<span class="op">^</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb12-13" title="13">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">.1</span>)</a>
<a class="sourceLine" id="cb12-14" title="14"></a>
<a class="sourceLine" id="cb12-15" title="15"><span class="co">### check that the mode of the generated samples is close to the theoretical mode</span></a>
<a class="sourceLine" id="cb12-16" title="16"><span class="kw">lines</span>(y, (y<span class="op">/</span>i<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>((<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>(i)<span class="op">^</span><span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb12-17" title="17">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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TnnF/AILPaZklVNeMb/AQo8pWeWUV8wvsNBjSlY55ZXmFwCICQKAaBAARIMAIBoEANEgAIgGAUA0CACiQQAQDQKAaBAARIMAIBoEANH4FWCn1MOb9oXfvOq7Vzz5y2z/yeXGYJ53q5WV37063ff1crcbv3vVyct7YY3iVYBdeQx35+PYeeE5r/3HPqtkVWaXO+N53q12Vl73qliXO7E910O/e9XNy3dhjeNTgPpOcpun/gvPefm+c+Puen9sz7vVzsrvXu2fq5ueNU/+8bxXnbwi32bTpwCd/ezutN+8jluvF9SderkUmufdamflea/q/Oqzvue96uQVYrdG8CrA6drWFGDnhee8jpsft9uzHrgK4He3Oml736syiyCF1ckrxG6N4FOAWvFG9M4Lz3kdVtW9GzceD+qlbnjerXZW/vfqcs9X/3t1zSvAbo2xSAGat0KclgMKoH3pNqt2H9izALvuuE+0jsAym0D1W8+vg+G2RGkC1Rn626vrPb8D7NVNo8dnYY2yzE5w/ZbH4bVQneBjXwBve7W91knve7W9bfRHGwtd5DBoXX5BTsu+h0F7rnnbq8vDH47+96qdl//CGmWZE2GnogvSCfY+EdYeBfK5V/vndsJ+96qbl/fCGsXvUohtPaFerJ+uL4LktVFK+WxUnmplkN1qZ+Vzr7b1o08e3gLs1U1evgtrFBbDgWgQAESDACAaBADRIACIBgFANAgAokEAEA0CgGgQAESDACAaBADRIACIBgFANAgAokEAEA0CgGgQAESDACAaBADRIACIBgFANAgAokEAEA0CgGgQAESDACAaBADRIACIBgFANAiQFtVTWQ6raM9MlAcCpEX1bJZt9dhECAMCJMbu3b8/i/S4LJEgQGpsVNQnp0sDAVJjF+9xQRJBgMQo1l/GemCiSBAgMbaP/10zCBQOBEiLw+o13jNzJYIAabF5/HCsHx4KQUAAEA0CgGgQAESDACAaBADRIACIBgFANAgAokEAEA0CgGgQAESDACAaBADRIACIBgFANAgAokEAEA0CgGgQAESDACAaBADRIACIBgFANAgAovk/KXuQ8uD1Aa8AAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>The above images are obtained successively with different sigma values σ=0.3,0.5,0.7,0.9. And the comparison between the histogram and the density function graph shows that the sample is relatively close to the theoretical value.</p>
</div>
<div id="question2" class="section level2">
<h2>Question2</h2>
<p>Generate a random sample of size 1000 from a normal location mixture. The components of the mixture have<span class="math inline">\(\mathrm{N}(0,1)\)</span> and <span class="math inline">\(\mathrm{N}(3,1)\)</span> distributions with mixing probabilities <span class="math inline">\(p1\)</span> and <span class="math inline">\(p2 =1 − p1\)</span>. Graph the histogram of the sample with density superimposed, for <span class="math inline">\(p1 =0.75\)</span>. Repeat with different values for <span class="math inline">\(p1\)</span> and observe whether the empirical distribution of the mixture appears to be bimodal. Make a conjecture about the values of <span class="math inline">\(p1\)</span> that produce bimodal mixtures.</p>
</div>
<div id="answer2" class="section level2">
<h2>Answer2</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb13-2" title="2">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb13-3" title="3">x1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>) </a>
<a class="sourceLine" id="cb13-4" title="4">x2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb13-5" title="5"></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="co">###Generate a random sample of size 1000 </span></a>
<a class="sourceLine" id="cb13-7" title="7">s &lt;-<span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2</a>
<a class="sourceLine" id="cb13-8" title="8">u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb13-9" title="9"></a>
<a class="sourceLine" id="cb13-10" title="10"><span class="co">### Graph the histogram when p1 =0.75</span></a>
<a class="sourceLine" id="cb13-11" title="11">k &lt;-<span class="st"> </span><span class="kw">as.integer</span>(u <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.75</span>) <span class="co">#vector of 0’s and 1’s</span></a>
<a class="sourceLine" id="cb13-12" title="12">x&lt;-k<span class="op">*</span>x1<span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>k) <span class="op">*</span><span class="st"> </span>x2  <span class="co">#the mixture</span></a>
<a class="sourceLine" id="cb13-13" title="13"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))<span class="co">#two graphs per page </span></a>
<a class="sourceLine" id="cb13-14" title="14"><span class="kw">hist</span>(s, <span class="dt">freq =</span> F, <span class="dt">breaks =</span> <span class="dv">30</span>) </a>
<a class="sourceLine" id="cb13-15" title="15"><span class="kw">lines</span>(<span class="kw">density</span>(s, <span class="dt">bw=</span>.<span class="dv">5</span>), <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb14-2" title="2">mean_s &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb14-3" title="3"></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="co">### Repeat with different values for p1 </span></a>
<a class="sourceLine" id="cb14-5" title="5">y&lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;head&quot;</span>, <span class="st">&quot;tail&quot;</span>), <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.6</span>, <span class="fl">0.4</span>))</a>
<a class="sourceLine" id="cb14-6" title="6">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">1000</span>, <span class="dt">mean =</span> mean_s[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb14-7" title="7">tails &lt;-<span class="st"> </span>y <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;tail&quot;</span>)</a>
<a class="sourceLine" id="cb14-8" title="8">x[tails] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">sum</span>(tails), <span class="dt">mean =</span> mean_s[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb14-9" title="9"><span class="kw">require</span>(lattice)</a></code></pre></div>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">densityplot</span>(<span class="op">~</span>x, <span class="dt">par.settings =</span> <span class="kw">list</span>(<span class="dt">plot.symbol =</span> <span class="kw">list</span>(<span class="dt">col =</span> <span class="kw">factor</span>(y))))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">y&lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;head&quot;</span>, <span class="st">&quot;tail&quot;</span>), <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>))</a>
<a class="sourceLine" id="cb17-2" title="2">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">1000</span>, <span class="dt">mean =</span> mean_s[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb17-3" title="3">tails &lt;-<span class="st"> </span>y <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;tail&quot;</span>)</a>
<a class="sourceLine" id="cb17-4" title="4">x[tails] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">sum</span>(tails), <span class="dt">mean =</span> mean_s[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb17-5" title="5"><span class="kw">require</span>(lattice)</a>
<a class="sourceLine" id="cb17-6" title="6"><span class="kw">densityplot</span>(<span class="op">~</span>x, <span class="dt">par.settings =</span> <span class="kw">list</span>(<span class="dt">plot.symbol =</span> <span class="kw">list</span>(<span class="dt">col =</span> <span class="kw">factor</span>(y))))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">y&lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;head&quot;</span>, <span class="st">&quot;tail&quot;</span>), <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>))</a>
<a class="sourceLine" id="cb18-2" title="2">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">1000</span>, <span class="dt">mean =</span> mean_s[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb18-3" title="3">tails &lt;-<span class="st"> </span>y <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;tail&quot;</span>)</a>
<a class="sourceLine" id="cb18-4" title="4">x[tails] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">sum</span>(tails), <span class="dt">mean =</span> mean_s[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb18-5" title="5"><span class="kw">require</span>(lattice)</a>
<a class="sourceLine" id="cb18-6" title="6"><span class="kw">densityplot</span>(<span class="op">~</span>x, <span class="dt">par.settings =</span> <span class="kw">list</span>(<span class="dt">plot.symbol =</span> <span class="kw">list</span>(<span class="dt">col =</span> <span class="kw">factor</span>(y))))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">y&lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;head&quot;</span>, <span class="st">&quot;tail&quot;</span>), <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>))</a>
<a class="sourceLine" id="cb19-2" title="2">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">1000</span>, <span class="dt">mean =</span> mean_s[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb19-3" title="3">tails &lt;-<span class="st"> </span>y <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;tail&quot;</span>)</a>
<a class="sourceLine" id="cb19-4" title="4">x[tails] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">sum</span>(tails), <span class="dt">mean =</span> mean_s[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb19-5" title="5"><span class="kw">require</span>(lattice)</a>
<a class="sourceLine" id="cb19-6" title="6"><span class="kw">densityplot</span>(<span class="op">~</span>x, <span class="dt">par.settings =</span> <span class="kw">list</span>(<span class="dt">plot.symbol =</span> <span class="kw">list</span>(<span class="dt">col =</span> <span class="kw">factor</span>(y))))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Make a conjecture</p>
<p>Combined with the figures, we can see that when p is closer to 0.5, the bimodal performance is more obvious, and when p1 is gradually away from 0.5, It’s not obvious.</p>
</div>
<div id="question3" class="section level2">
<h2>Question3</h2>
<p>Write a function to generate a random sample from a Wd(Σ,n)(Wishart) distribution for <span class="math inline">\(n&gt;d+1 ≥ 1\)</span>, based on Bartlett’s decomposition.</p>
</div>
<div id="answer3" class="section level2">
<h2>Answer3</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">require</span>(graphics)</a>
<a class="sourceLine" id="cb20-2" title="2"><span class="co">### generate a funtion</span></a>
<a class="sourceLine" id="cb20-3" title="3">runif.wis&lt;-<span class="cf">function</span>(sigma,n){</a>
<a class="sourceLine" id="cb20-4" title="4">  p&lt;-<span class="kw">ncol</span>(sigma)</a>
<a class="sourceLine" id="cb20-5" title="5">  l&lt;-<span class="kw">chol</span>(sigma)</a>
<a class="sourceLine" id="cb20-6" title="6">  A&lt;-<span class="kw">matrix</span>(<span class="dt">ncol=</span>p,<span class="dt">nrow=</span>p)</a>
<a class="sourceLine" id="cb20-7" title="7">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>p){</a>
<a class="sourceLine" id="cb20-8" title="8">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>p){</a>
<a class="sourceLine" id="cb20-9" title="9">    A[i,j]=<span class="kw">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb20-10" title="10">  }</a>
<a class="sourceLine" id="cb20-11" title="11">  }</a>
<a class="sourceLine" id="cb20-12" title="12">  A[<span class="kw">lower.tri</span>(A)]=<span class="dv">0</span></a>
<a class="sourceLine" id="cb20-13" title="13">  c&lt;-<span class="kw">numeric</span>(p)</a>
<a class="sourceLine" id="cb20-14" title="14">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>p){</a>
<a class="sourceLine" id="cb20-15" title="15">    c[i]=<span class="kw">rchisq</span>(<span class="dv">1</span>,n<span class="op">-</span>i<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb20-16" title="16">    A[i,i]=c[i]</a>
<a class="sourceLine" id="cb20-17" title="17">  }</a>
<a class="sourceLine" id="cb20-18" title="18">  s&lt;-l<span class="op">%*%</span>A<span class="op">%*%</span><span class="kw">t</span>(A)<span class="op">%*%</span><span class="kw">t</span>(l)</a>
<a class="sourceLine" id="cb20-19" title="19">  <span class="kw">return</span>(s)</a>
<a class="sourceLine" id="cb20-20" title="20">}</a></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="co">### generate  random sample from Wishart</span></a>
<a class="sourceLine" id="cb21-2" title="2">m&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="dv">2</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb21-3" title="3">k&lt;-<span class="dv">2</span><span class="op">*</span><span class="kw">diag</span>(<span class="dv">8</span>)</a>
<a class="sourceLine" id="cb21-4" title="4">sigma1&lt;-m</a>
<a class="sourceLine" id="cb21-5" title="5">sigma2&lt;-k</a>
<a class="sourceLine" id="cb21-6" title="6">n&lt;-<span class="dv">18</span></a>
<a class="sourceLine" id="cb21-7" title="7"><span class="kw">runif.wis</span>(sigma1,n)</a></code></pre></div>
<pre><code>##           [,1]     [,2]
## [1,] 3645.8306 385.0252
## [2,]  385.0252 893.9999</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">runif.wis</span>(sigma2,n)</a></code></pre></div>
<pre><code>##             [,1]        [,2]       [,3]       [,4]       [,5]       [,6]
## [1,] 405.4084245   20.743233 -15.879325  47.528103 -25.486407  28.022574
## [2,]  20.7432333 1359.931132  15.083975  35.769957  18.696972  13.481465
## [3,] -15.8793253   15.083975 322.696560  33.978733 -55.078204   1.329807
## [4,]  47.5281025   35.769957  33.978733 551.107089  13.277672   4.138431
## [5,] -25.4864072   18.696972 -55.078204  13.277672 685.408182   2.504223
## [6,]  28.0225741   13.481465   1.329807   4.138431   2.504223 381.009206
## [7,]  -6.0215793   -4.681332   1.215766   8.674012   5.591011  -9.959489
## [8,]  -0.8125895   76.785227  61.106663 -17.690942   1.794394  -1.597250
##           [,7]        [,8]
## [1,] -6.021579  -0.8125895
## [2,] -4.681332  76.7852269
## [3,]  1.215766  61.1066634
## [4,]  8.674012 -17.6909416
## [5,]  5.591011   1.7943942
## [6,] -9.959489  -1.5972496
## [7,] 44.211067  10.4549480
## [8,] 10.454948 925.7437736</code></pre>
</div>
<div id="homework-3" class="section level2">
<h2>HomeWork 3</h2>
</div>
<div id="questuon1" class="section level2">
<h2>Questuon1</h2>
<p>Compute a Monte Carlo estimate of <span class="math display">\[\int_{0}^{\pi / 3} \sin t d t\]</span> and compare your estimate with the exact value of the integral.</p>
<p>##Answer1</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">set.seed</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb25-2" title="2">m&lt;-<span class="dv">10000</span></a>
<a class="sourceLine" id="cb25-3" title="3">t&lt;-<span class="kw">runif</span>(m,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span>pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb25-4" title="4"></a>
<a class="sourceLine" id="cb25-5" title="5"><span class="co">### Compute a Monte Carlo estimate</span></a>
<a class="sourceLine" id="cb25-6" title="6">theta.hat&lt;-<span class="kw">mean</span>(<span class="kw">sin</span>(t))<span class="op">*</span>(pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb25-7" title="7"><span class="kw">print</span>(theta.hat)</a></code></pre></div>
<pre><code>## [1] 0.4998228</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="co">### compare your estimate with the exact value of the integral</span></a>
<a class="sourceLine" id="cb27-2" title="2"><span class="kw">print</span>((<span class="kw">cos</span>(<span class="dv">0</span>)<span class="op">-</span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">3</span>))<span class="op">-</span>theta.hat)</a></code></pre></div>
<pre><code>## [1] 0.0001771703</code></pre>
<p>##Question2</p>
<p>Use Monte Carlo integration with antithetic variables to estimate <span class="math display">\[\int_{0}^{1} \frac{e^{-x}}{1+x^{2}} d x\]</span> and find the approximate reduction in variance as a percentage of the variance without variance reduction.</p>
<p>##Answer2</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb29-2" title="2"></a>
<a class="sourceLine" id="cb29-3" title="3"><span class="co">## antithetic variables to estimate</span></a>
<a class="sourceLine" id="cb29-4" title="4">MC.Phi &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">R =</span> <span class="dv">10000</span>, <span class="dt">antithetic =</span> <span class="ot">TRUE</span>) {</a>
<a class="sourceLine" id="cb29-5" title="5">u &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>) </a>
<a class="sourceLine" id="cb29-6" title="6"><span class="cf">if</span> (<span class="op">!</span>antithetic)</a>
<a class="sourceLine" id="cb29-7" title="7">v &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>) <span class="cf">else</span></a>
<a class="sourceLine" id="cb29-8" title="8">v&lt;-<span class="dv">1</span><span class="op">-</span><span class="st"> </span>u</a>
<a class="sourceLine" id="cb29-9" title="9">u &lt;-<span class="st"> </span><span class="kw">c</span>(u, v)</a>
<a class="sourceLine" id="cb29-10" title="10">theta.hat &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(x))</a>
<a class="sourceLine" id="cb29-11" title="11"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="op">:</span><span class="kw">length</span>(x)) { </a>
<a class="sourceLine" id="cb29-12" title="12">g &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">exp</span>(<span class="op">-</span>u<span class="op">*</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>(u<span class="op">*</span>x)<span class="op">^</span><span class="dv">2</span>)) </a>
<a class="sourceLine" id="cb29-13" title="13">} </a>
<a class="sourceLine" id="cb29-14" title="14">g</a>
<a class="sourceLine" id="cb29-15" title="15">}</a></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb30-2" title="2">MC1 &lt;-<span class="st"> </span><span class="kw">MC.Phi</span>(<span class="dv">1</span>, <span class="dt">anti =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb30-3" title="3"><span class="kw">print</span>(MC1)</a></code></pre></div>
<pre><code>## [1] 0.5263106</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>) </a>
<a class="sourceLine" id="cb32-2" title="2">MC2 &lt;-<span class="st"> </span><span class="kw">MC.Phi</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb32-3" title="3"><span class="kw">print</span>(MC2)</a></code></pre></div>
<pre><code>## [1] 0.5246837</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb34-2" title="2">m &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb34-3" title="3">MC1 &lt;-<span class="st"> </span>MC2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) </a>
<a class="sourceLine" id="cb34-4" title="4">x &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb34-5" title="5"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb34-6" title="6">   MC1[i] &lt;-<span class="st"> </span><span class="kw">MC.Phi</span>(x, <span class="dt">R =</span> <span class="dv">1000</span>, <span class="dt">anti =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb34-7" title="7">   MC2[i] &lt;-<span class="st"> </span><span class="kw">MC.Phi</span>(x, <span class="dt">R =</span> <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb34-8" title="8">}</a>
<a class="sourceLine" id="cb34-9" title="9"> <span class="kw">print</span>(<span class="kw">sd</span>(MC1))</a></code></pre></div>
<pre><code>## [1] 0.007756972</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"> <span class="kw">print</span>(<span class="kw">sd</span>(MC2))</a></code></pre></div>
<pre><code>## [1] 0.001475217</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"> <span class="co">## approximate reduction in variance</span></a>
<a class="sourceLine" id="cb38-2" title="2"> <span class="kw">print</span>((<span class="kw">var</span>(MC1) <span class="op">-</span><span class="st"> </span><span class="kw">var</span>(MC2))<span class="op">/</span><span class="kw">var</span>(MC1))</a></code></pre></div>
<pre><code>## [1] 0.9638317</code></pre>
</div>
<div id="question3-1" class="section level2">
<h2>Question3</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
<p>##Answer3</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1">m&lt;-<span class="dv">10000</span>   <span class="co"># number of replicates</span></a>
<a class="sourceLine" id="cb40-2" title="2"><span class="kw">set.seed</span>(<span class="dv">0</span>) </a>
<a class="sourceLine" id="cb40-3" title="3">k&lt;-<span class="dv">5</span>      <span class="co"># number of strata</span></a>
<a class="sourceLine" id="cb40-4" title="4">r&lt;-m<span class="op">/</span>k    </a>
<a class="sourceLine" id="cb40-5" title="5">N&lt;-<span class="dv">50</span>     <span class="co"># number of times to repeat the estimation</span></a>
<a class="sourceLine" id="cb40-6" title="6">T2&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb40-7" title="7">estimates&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb40-8" title="8">g&lt;-<span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb40-9" title="9">  <span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span>(x<span class="op">&lt;</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb40-10" title="10">}</a>
<a class="sourceLine" id="cb40-11" title="11"><span class="co">## stratified importance sampling</span></a>
<a class="sourceLine" id="cb40-12" title="12"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb40-13" title="13"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) {</a>
<a class="sourceLine" id="cb40-14" title="14"></a>
<a class="sourceLine" id="cb40-15" title="15">    u&lt;-<span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.6</span>,<span class="fl">0.8</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb40-16" title="16">    q&lt;-<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))   </a>
<a class="sourceLine" id="cb40-17" title="17">    u1&lt;-<span class="kw">runif</span>(m<span class="op">/</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb40-18" title="18">    y&lt;-<span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>q[i])<span class="op">-</span>u1<span class="op">/</span><span class="dv">5</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb40-19" title="19">    f1&lt;-<span class="kw">g</span>(y)<span class="op">/</span>(<span class="dv">5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb40-20" title="20">    T2[i]&lt;-<span class="kw">mean</span>(f1)</a>
<a class="sourceLine" id="cb40-21" title="21">}</a>
<a class="sourceLine" id="cb40-22" title="22"> estimates[j,<span class="dv">2</span>]&lt;-<span class="kw">sum</span>(T2)</a>
<a class="sourceLine" id="cb40-23" title="23"> </a>
<a class="sourceLine" id="cb40-24" title="24"><span class="co">##inverse transformated method</span></a>
<a class="sourceLine" id="cb40-25" title="25"></a>
<a class="sourceLine" id="cb40-26" title="26">  u2&lt;-<span class="kw">runif</span>(m)</a>
<a class="sourceLine" id="cb40-27" title="27">  x&lt;-<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u2<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))    </a>
<a class="sourceLine" id="cb40-28" title="28">  f2&lt;-<span class="kw">g</span>(x)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb40-29" title="29">  estimates[j,<span class="dv">1</span>]&lt;-<span class="kw">mean</span>(f2)</a>
<a class="sourceLine" id="cb40-30" title="30">} </a>
<a class="sourceLine" id="cb40-31" title="31"></a>
<a class="sourceLine" id="cb40-32" title="32"></a>
<a class="sourceLine" id="cb40-33" title="33"></a>
<a class="sourceLine" id="cb40-34" title="34"><span class="kw">print</span>(estimates)</a></code></pre></div>
<pre><code>##            [,1]      [,2]
##  [1,] 0.5245498 0.5246857
##  [2,] 0.5249511 0.5250183
##  [3,] 0.5239855 0.5245600
##  [4,] 0.5251879 0.5248100
##  [5,] 0.5256952 0.5248839
##  [6,] 0.5251446 0.5249146
##  [7,] 0.5242177 0.5249454
##  [8,] 0.5248377 0.5245311
##  [9,] 0.5241379 0.5251162
## [10,] 0.5240995 0.5246340
## [11,] 0.5248375 0.5249225
## [12,] 0.5251257 0.5245562
## [13,] 0.5249633 0.5251531
## [14,] 0.5251238 0.5249914
## [15,] 0.5242077 0.5247944
## [16,] 0.5247844 0.5248468
## [17,] 0.5246605 0.5250987
## [18,] 0.5253756 0.5249435
## [19,] 0.5265980 0.5250123
## [20,] 0.5245756 0.5245040
## [21,] 0.5255292 0.5249998
## [22,] 0.5255616 0.5249353
## [23,] 0.5255642 0.5249952
## [24,] 0.5248491 0.5246488
## [25,] 0.5236060 0.5246060
## [26,] 0.5243205 0.5246020
## [27,] 0.5257868 0.5248979
## [28,] 0.5238976 0.5243605
## [29,] 0.5239185 0.5247587
## [30,] 0.5249074 0.5249289
## [31,] 0.5249188 0.5246101
## [32,] 0.5242179 0.5251499
## [33,] 0.5228814 0.5246164
## [34,] 0.5270135 0.5245654
## [35,] 0.5250114 0.5246769
## [36,] 0.5241796 0.5244855
## [37,] 0.5246165 0.5249057
## [38,] 0.5262008 0.5247452
## [39,] 0.5251681 0.5251243
## [40,] 0.5220988 0.5243908
## [41,] 0.5255706 0.5247559
## [42,] 0.5230171 0.5249058
## [43,] 0.5239906 0.5246650
## [44,] 0.5244031 0.5245729
## [45,] 0.5226575 0.5247670
## [46,] 0.5272689 0.5252071
## [47,] 0.5225333 0.5247050
## [48,] 0.5240402 0.5249938
## [49,] 0.5266532 0.5247493
## [50,] 0.5251067 0.5250625</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="kw">apply</span>(estimates,<span class="dv">2</span>,mean)</a></code></pre></div>
<pre><code>## [1] 0.5247310 0.5248062</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="kw">apply</span>(estimates,<span class="dv">2</span>,var)</a></code></pre></div>
<pre><code>## [1] 1.149196e-06 4.634811e-08</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="kw">print</span>((<span class="kw">var</span>(estimates[,<span class="dv">1</span>])<span class="op">-</span><span class="kw">var</span>(estimates[,<span class="dv">2</span>]))<span class="op">/</span><span class="kw">var</span>(estimates[,<span class="dv">1</span>]))</a></code></pre></div>
<pre><code>## [1] 0.9596691</code></pre>
</div>
<div id="homework-4" class="section level2">
<h2>Homework 4</h2>
</div>
<div id="question1" class="section level2">
<h2>Question1</h2>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of χ2(2) data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
<div id="answer1" class="section level2">
<h2>Answer1</h2>
<div id="estimate-the-coverage-probability" class="section level3">
<h3>estimate the coverage probability</h3>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="kw">set.seed</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb48-2" title="2">n&lt;-<span class="dv">20</span> </a>
<a class="sourceLine" id="cb48-3" title="3">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb48-4" title="4"><span class="co"># sample mean of x : mean(x)</span></a>
<a class="sourceLine" id="cb48-5" title="5"><span class="co"># standard deviation of x : sd(x)</span></a>
<a class="sourceLine" id="cb48-6" title="6"><span class="co"># the 97.5th percentile of the t-distribution with n degrees of freedom : qt(0.975, n)</span></a>
<a class="sourceLine" id="cb48-7" title="7"></a>
<a class="sourceLine" id="cb48-8" title="8">inORnot &lt;-<span class="st"> </span><span class="cf">function</span>(alpha, n, mu) {</a>
<a class="sourceLine" id="cb48-9" title="9"></a>
<a class="sourceLine" id="cb48-10" title="10">   x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">2</span>) </a>
<a class="sourceLine" id="cb48-11" title="11"></a>
<a class="sourceLine" id="cb48-12" title="12">  L =<span class="st"> </span><span class="kw">mean</span>(x) <span class="op">-</span><span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n)</a>
<a class="sourceLine" id="cb48-13" title="13">  U =<span class="st"> </span><span class="kw">mean</span>(x) <span class="op">+</span><span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n)</a>
<a class="sourceLine" id="cb48-14" title="14"></a>
<a class="sourceLine" id="cb48-15" title="15">  <span class="kw">return</span>(L <span class="op">&lt;=</span><span class="st"> </span>mu <span class="op">&amp;</span><span class="st"> </span>U <span class="op">&gt;=</span><span class="st"> </span>mu)</a>
<a class="sourceLine" id="cb48-16" title="16"></a>
<a class="sourceLine" id="cb48-17" title="17">}</a>
<a class="sourceLine" id="cb48-18" title="18"></a>
<a class="sourceLine" id="cb48-19" title="19">covPro &lt;-<span class="st"> </span><span class="cf">function</span>(alpha, S, n) {</a>
<a class="sourceLine" id="cb48-20" title="20"></a>
<a class="sourceLine" id="cb48-21" title="21">  cum =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb48-22" title="22">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>S) cum =<span class="st"> </span>cum <span class="op">+</span><span class="st"> </span><span class="kw">inORnot</span>(alpha, n, <span class="dt">mu =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb48-23" title="23">  <span class="kw">return</span>(cum <span class="op">/</span><span class="st"> </span>S)</a>
<a class="sourceLine" id="cb48-24" title="24"></a>
<a class="sourceLine" id="cb48-25" title="25">}</a>
<a class="sourceLine" id="cb48-26" title="26"></a>
<a class="sourceLine" id="cb48-27" title="27"> <span class="kw">covPro</span>(<span class="dt">alpha =</span> <span class="fl">0.05</span>, <span class="dt">S =</span> <span class="dv">1000</span>, <span class="dt">n =</span> <span class="dv">20</span>)</a></code></pre></div>
<pre><code>## [1] 0.929</code></pre>
</div>
<div id="compare-the-t-interval-results-with-the-simulation-results-in-example-6.4" class="section level3">
<h3>Compare the t-interval results with the simulation results in Example 6.4</h3>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="kw">set.seed</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb50-2" title="2">n&lt;-<span class="dv">20</span></a>
<a class="sourceLine" id="cb50-3" title="3">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb50-4" title="4">UCL &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> { </a>
<a class="sourceLine" id="cb50-5" title="5">  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb50-6" title="6">  (n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">qchisq</span>(alpha, <span class="dt">df =</span> n<span class="dv">-1</span>) </a>
<a class="sourceLine" id="cb50-7" title="7">  })</a>
<a class="sourceLine" id="cb50-8" title="8"><span class="co">#count the number of intervals that contain sigma^2=4 </span></a>
<a class="sourceLine" id="cb50-9" title="9"><span class="kw">sum</span>(UCL <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>) </a></code></pre></div>
<pre><code>## [1] 806</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="co">#or compute the mean to get the confidence level </span></a>
<a class="sourceLine" id="cb52-2" title="2"><span class="kw">mean</span>(UCL <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>)</a></code></pre></div>
<pre><code>## [1] 0.806</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="co"># from the answer we can know that The t-interval(92.9%) is more robust to departures from normality than the interval for variance which is 80.6%.</span></a></code></pre></div>
</div>
</div>
<div id="question2-1" class="section level2">
<h2>Question2</h2>
<p>Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness <span class="math inline">\(\sqrt{b_{1}}\)</span> under normality by a Monte Carlo experiment. Compute the standard error of the estimates from (2.14) using the normal approximation for the density (with exact variance formula). Compare the estimated quantiles with the quantiles of the large sample approximation <span class="math inline">\(\sqrt{b_{1}} \approx N(0,6 / n)\)</span>.</p>
</div>
<div id="answer2-1" class="section level2">
<h2>Answer2</h2>
<div id="estimate-quantiles" class="section level3">
<h3>Estimate quantiles</h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1">n=<span class="dv">1000</span></a>
<a class="sourceLine" id="cb55-2" title="2"><span class="kw">set.seed</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb55-3" title="3">sk&lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb55-4" title="4">  <span class="co">#computes the sample skewness coeff</span></a>
<a class="sourceLine" id="cb55-5" title="5">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb55-6" title="6">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>) </a>
<a class="sourceLine" id="cb55-7" title="7">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>) </a>
<a class="sourceLine" id="cb55-8" title="8">  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb55-9" title="9">}</a>
<a class="sourceLine" id="cb55-10" title="10">skew&lt;-<span class="kw">numeric</span>(<span class="dv">50</span>)</a>
<a class="sourceLine" id="cb55-11" title="11"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">50</span>){</a>
<a class="sourceLine" id="cb55-12" title="12">  x&lt;-<span class="kw">rnorm</span>(<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb55-13" title="13">  skew[i]&lt;-<span class="kw">sk</span>(x)</a>
<a class="sourceLine" id="cb55-14" title="14">}</a>
<a class="sourceLine" id="cb55-15" title="15"><span class="kw">quantile</span>(skew,<span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>))</a></code></pre></div>
<pre><code>##       2.5%         5%        95%      97.5% 
## -0.1556104 -0.1303459  0.1214173  0.1300384</code></pre>
</div>
<div id="compute-the-standard-error" class="section level3">
<h3>compute the standard error</h3>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1">varq&lt;-<span class="cf">function</span>(n,q,xq){</a>
<a class="sourceLine" id="cb57-2" title="2">    <span class="kw">return</span> (q<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>q)<span class="op">/</span>(n<span class="op">*</span><span class="kw">dnorm</span>(xq,<span class="dv">0</span>,<span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb57-3" title="3">}</a>
<a class="sourceLine" id="cb57-4" title="4"><span class="kw">sqrt</span>(<span class="kw">varq</span>(<span class="dv">1000</span>,<span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>),<span class="kw">quantile</span>(skew,<span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>))))</a></code></pre></div>
<pre><code>##       2.5%         5%        95%      97.5% 
## 0.01252623 0.01742313 0.01740355 0.01248056</code></pre>
</div>
<div id="compare-the-estimated-quantiles-with-the-quantiles" class="section level3">
<h3>Compare the estimated quantiles with the quantiles</h3>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1">n&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb59-2" title="2">c2 &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>), <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n))</a>
<a class="sourceLine" id="cb59-3" title="3">c1&lt;-<span class="kw">unname</span>(<span class="kw">quantile</span>(skew,<span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>)))</a>
<a class="sourceLine" id="cb59-4" title="4">c&lt;-<span class="kw">cbind</span>(c1,c2)</a>
<a class="sourceLine" id="cb59-5" title="5"><span class="kw">print</span>(c)</a></code></pre></div>
<pre><code>##              c1         c2
## [1,] -0.1556104 -0.1518182
## [2,] -0.1303459 -0.1274098
## [3,]  0.1214173  0.1274098
## [4,]  0.1300384  0.1518182</code></pre>
</div>
</div>
<div id="homework-5" class="section level2">
<h2>Homework 5</h2>
</div>
<div id="question-1-1" class="section level2">
<h2>Question 1</h2>
<p>Estimate the power of the skewness test of normality against symmetric Beta(α, α)distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as t(ν)?</p>
</div>
<div id="answer-1-1" class="section level2">
<h2>Answer 1</h2>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="kw">library</span>(energy)</a>
<a class="sourceLine" id="cb61-2" title="2"></a>
<a class="sourceLine" id="cb61-3" title="3">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) { </a>
<a class="sourceLine" id="cb61-4" title="4"><span class="co">#computes the sample skewness coeff. </span></a>
<a class="sourceLine" id="cb61-5" title="5">xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x) </a>
<a class="sourceLine" id="cb61-6" title="6">m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb61-7" title="7">m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb61-8" title="8"><span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb61-9" title="9">}</a>
<a class="sourceLine" id="cb61-10" title="10">alpha&lt;-<span class="fl">0.05</span></a>
<a class="sourceLine" id="cb61-11" title="11"><span class="kw">set.seed</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb61-12" title="12">n&lt;-<span class="dv">30</span></a>
<a class="sourceLine" id="cb61-13" title="13">m&lt;-<span class="dv">3300</span></a>
<a class="sourceLine" id="cb61-14" title="14">para&lt;-<span class="dv">1</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb61-15" title="15">N&lt;-<span class="kw">length</span>(para)</a>
<a class="sourceLine" id="cb61-16" title="16">pwr&lt;-<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb61-17" title="17"><span class="co"># critical value for the skewness test</span></a>
<a class="sourceLine" id="cb61-18" title="18">cv&lt;-<span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb61-19" title="19"></a>
<a class="sourceLine" id="cb61-20" title="20"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb61-21" title="21"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb61-22" title="22">  p&lt;-para[j]</a>
<a class="sourceLine" id="cb61-23" title="23">  sktests&lt;-<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb61-24" title="24">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb61-25" title="25">    x&lt;-<span class="kw">rbeta</span>(n,p,p)</a>
<a class="sourceLine" id="cb61-26" title="26">    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(</a>
<a class="sourceLine" id="cb61-27" title="27">   <span class="kw">shapiro.test</span>(x)<span class="op">$</span>p.value <span class="op">&lt;=</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb61-28" title="28">  }</a>
<a class="sourceLine" id="cb61-29" title="29">  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb61-30" title="30">}</a>
<a class="sourceLine" id="cb61-31" title="31"></a>
<a class="sourceLine" id="cb61-32" title="32"><span class="co">#plot power vs parameter</span></a>
<a class="sourceLine" id="cb61-33" title="33"><span class="kw">plot</span>(para,pwr,<span class="dt">type=</span><span class="st">&#39;b&#39;</span>,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAACVBMVEUAAAAA/wD///9JuQheAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADsUlEQVR4nO3ci07bMABAUbr//+hJ3QsYyW3zoK19rgSaHAXKKbGdDvXth1Z7e/QDePYARYAiQBGgCFAEKAIUAYoARYAiQBGgCFAEKAIUAYoARV8BvU3brUAHPwkvE6AIUAQoAhTdC3S5XE58NE/YnUCX3x/ztA70eTtwefd5ku77DQIUY4BqzBxUY1axO8amCFAEKAIUAYruB7KKAXofoAhQtGGSnksIUAQoAhQBigBFgCJA0Zab1amEAEWAIkARoAhQBCgCFG160X4mIUARoAhQBCgCFAGKAEXb/nhhIiFAEaAIUAQoAhQBigBFG/+Icx4hQBGgCFAEKAIUAYoARRuB5hECFAGKAEWAIkARoAhQtBVoGqF1jJV3ywMUY4BiDFCMAYoxQDEGKMYA1dgkQoAiQBGgCFAEKAIUAYq2A00iBCgCFAGKAEWAIkARoGgH0BxCgCJAEaAIUAQoAhQBivYATSEEKAIUAYoARYAiQBGgaBfQDEKAIkARoAhQBCgCFO0DmkAIUAQoAhQBigBFgCJA0U6g8YUARYAiQBGgCFAEKAIU7QUaXghQtI6x8v5Bf5obaH3sGqDlsWuAlseuAVoeuwZoeewaoOWxXw0uBCgCFAGKAEWAIkARoGg/0OBCgCJAEaAIUAQoAhQBig4AGlsIUAQoAhQBigBFgCJA0RFAQwsBigBFgCJAEaAIUAQoOgRoZCFAEaAIUAQoAhQBigBFxwANLAQoAhQBigBFgCJAEaDoIKBxhQBFgCJAEaAIUAQoAhQdBTSs0DrGDW+P86c5gdbHPgQoAjRpgCJAEaAIUHQc0OUy5EJ26DI/otCx92IDCgGKAEXmoMgqFtkHRYAiQNHhQKNNRMf/Bg0mdMIlNpbQGXPQUEKnTNIjCZ2zig0kdNIyP86u+rR90ChC520UBxE6cSc9htCZtxpDCJ16LzaC0Lk3qwMIuZuPAEUPBXqFV2m/AWiR4SVe5z8faJHhNf6n6HSgDwyXX31x5Gn7XqDFI5dP1+HzzE4PBPp88b1D2jI7bTBdPuXfkQfOQcsPcA11w4y/9m3yyCNXseUz3n3+/8i9M/7SObdd/E+5Ufw8O/29+G6c8T88JYsOt32xpwTa+aRf//XlT7usvfjFnhNo6bLccCFtuV6/eQ46sg1T8ZrDU6xix7Zlg7RrU/VqQN8eoAhQBCgCFN0MNG03Am20fopTDv82gADtOwUQoH2nAAK07xRAgPadAugcoHkCFAGKAEWAIkARoAhQBCj6CVH5fgrAr9KtAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb62-2" title="2">  p&lt;-para[j]</a>
<a class="sourceLine" id="cb62-3" title="3">  sktests&lt;-<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb62-4" title="4">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb62-5" title="5">    y&lt;-<span class="kw">rt</span>(n,p)</a>
<a class="sourceLine" id="cb62-6" title="6">    sktests[i]&lt;-<span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(y))<span class="op">&gt;=</span>cv)</a>
<a class="sourceLine" id="cb62-7" title="7">  }</a>
<a class="sourceLine" id="cb62-8" title="8">  pwr[j]&lt;-<span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb62-9" title="9">}</a>
<a class="sourceLine" id="cb62-10" title="10"></a>
<a class="sourceLine" id="cb62-11" title="11"><span class="kw">plot</span>(para,pwr,<span class="dt">type=</span><span class="st">&#39;b&#39;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAACVBMVEUAAAD/AAD///9nGWQeAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEIklEQVR4nO3ci24aMRBAUcj/f3RVhSTbB9xl/ZoZ3yu1UqhIo1OwvV6X24e97Lb6B4ieQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBA0P+Abtt2FqjzP0KaBIIEggSCBILeBbrf7wN/moC9CXR//Nqn94Duh983SSBIIMgxCHIWg1wHQQJBAkECQQJBV4C2mscEgi69xXYSEggSCLo2i20kJBAkEPQa4+kNxn2ELq6kBYLHBKLHthESCBIIurzdsYuQQND1DbNNhASCBIIa9qT3EBIIEghque2zhZBAkEBQ053VHYQEggSC2g4vbCAkECQQ1Hg+qL6QQJBAUOsRvPJCAkECQc2nXKsLCQQJBF08H3SouFD7SXuBnj72mUBPH3tUW0ggqANQbSGBIIGgHkClhQSCBIK6AFUWEggSCOoDVFhIIEggqBNQXSGBoF5AZRMIEggSCBII6gdU9PPxugFV/YTFvuuggkICQQJBjkGQsxjkOggSCGo/QFU8X0GQQFBfoILzmEBQ57dYPSGBoN6DdDkhgaDu03w1IYGg/gvFYkICQQJBA67FagkJBI24mi8lJBA0ZD+okpBA0JgdxUJCAkECQYM27esICQSNuu1TRkggaNiNwypCAkECQePuzRcREggaeD6ohtDA4y8CUSWEBIKGnjCrICQQJBA09hBnASGBoMHHgPMLCQSNPkieXkggaDRQeiGBoOFA2RMIEggSCBIImgCU+/+LjwdK/okDk9ZBeYUEggSCHIMgZzHIdRAkECQQNA8o6UA08RWUU2jg+aB/Sik0cwwSiMooNHcWSyg0eZrPJyQQNHuhmE5o+ko6m9D8S41kQguuxXIJCQStuJpPJbRkuyOT0Jr9oERCAkGLdhTzCK3ack0j5J40JBAkECQQtBQow03plUApjjUsBMpxMEYgSCDIMQhyFoNcB0ECQSGAIr/RQgBFFpp5PuhFcUfrGK+gj7gvojBAUYXiAAUVCgQUUygSUMihOhRQxBdRMKB4QtGAwiUQFBQozkZITKBAW2khgSJtxgoECQSFBHIMwpzFzrYcKjrQcqL4QIuJMgAtJcoBtJAoC9CysgFNn/+TAc1fQeYCWnANIhAkEJQL6I8x6D5lwE4G9PcsdkAaxJUN6Gmj5rcqQMNGJ4GgIAeomvMVRDkGUcf5rOO3rQN0rOMSqSbQ7zqtkOoCfdc2OtUHapzfBIIEguoDOQZhzmJnuwK1FdAVos2A3ifaDuhdog2B3iPaEuirM9PbzkAvFkg/dBsDvVhiH+gEenxxfLcd/0Sgn6+/kQT67OkYJNCjp7OYYxDlLHY6gSCBIIEggaDTQNt2EuiidYindP9rBBKo7SkCCdT2FIEEanuKQAK1PUWgMUD7JBAkECQQJBAkECQQJBAkEPQLVcV+FTtg4G8AAAAASUVORK5CYII=" /><!-- --></p>
<div id="conclusion" class="section level3">
<h3>conclusion</h3>
<p>By trying the parameters from 1 to 10,We can see the power of Beta(α, α) is smaller than that of t(ν),which means t(ν) is more closer to normal distribution than Beta(α, α).</p>
</div>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<p>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level α, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) χ2(1) , (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case, test H0 : µ = µ0 vs H0 : µ = µ0,where µ0 is the mean of χ2(1), Uniform(0,2), and Exponential(1), respectively.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer 2</h2>
<div id="sample-population-is-χ21" class="section level3">
<h3>sample population is χ2(1)</h3>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="kw">set.seed</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb63-2" title="2">n&lt;-<span class="dv">50</span></a>
<a class="sourceLine" id="cb63-3" title="3">alpha &lt;-<span class="st"> </span><span class="fl">.05</span> </a>
<a class="sourceLine" id="cb63-4" title="4">mu0&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb63-5" title="5">m &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb63-6" title="6"><span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb63-7" title="7">p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) </a>
<a class="sourceLine" id="cb63-8" title="8"><span class="co">#storage for p-values </span></a>
<a class="sourceLine" id="cb63-9" title="9"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </a>
<a class="sourceLine" id="cb63-10" title="10">  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb63-11" title="11">  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="dt">mu =</span> mu0) </a>
<a class="sourceLine" id="cb63-12" title="12">  p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb63-13" title="13">  }</a>
<a class="sourceLine" id="cb63-14" title="14">p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb63-15" title="15"><span class="kw">print</span>(p.hat)</a></code></pre></div>
<pre><code>## [1] 0.0755</code></pre>
</div>
<div id="sample-population-is-uniform02" class="section level3">
<h3>sample population is Uniform(0,2)</h3>
<p>set.seed(0)</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1">n&lt;-<span class="dv">50</span></a>
<a class="sourceLine" id="cb65-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">.05</span> </a>
<a class="sourceLine" id="cb65-3" title="3">a&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb65-4" title="4">mu0&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb65-5" title="5">m &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb65-6" title="6"><span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb65-7" title="7">p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) </a>
<a class="sourceLine" id="cb65-8" title="8"><span class="co">#storage for p-values </span></a>
<a class="sourceLine" id="cb65-9" title="9"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </a>
<a class="sourceLine" id="cb65-10" title="10">  x &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb65-11" title="11">  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="dt">mu =</span> mu0) </a>
<a class="sourceLine" id="cb65-12" title="12">  p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb65-13" title="13">  }</a>
<a class="sourceLine" id="cb65-14" title="14">p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb65-15" title="15"><span class="kw">print</span>(p.hat)</a></code></pre></div>
<pre><code>## [1] 0.0529</code></pre>
</div>
<div id="sample-population-is-exponential1" class="section level3">
<h3>sample population is Exponential(1)</h3>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1">n&lt;-<span class="dv">50</span></a>
<a class="sourceLine" id="cb67-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">.05</span> </a>
<a class="sourceLine" id="cb67-3" title="3">a&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb67-4" title="4">mu0&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb67-5" title="5">m &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb67-6" title="6"><span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb67-7" title="7">p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) </a>
<a class="sourceLine" id="cb67-8" title="8"><span class="co">#storage for p-values </span></a>
<a class="sourceLine" id="cb67-9" title="9"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </a>
<a class="sourceLine" id="cb67-10" title="10">  x &lt;-<span class="st"> </span><span class="kw">rexp</span>(n, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb67-11" title="11">  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="dt">mu =</span> mu0) </a>
<a class="sourceLine" id="cb67-12" title="12">  p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb67-13" title="13">  }</a>
<a class="sourceLine" id="cb67-14" title="14">p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb67-15" title="15"><span class="kw">print</span>(p.hat)</a></code></pre></div>
<pre><code>## [1] 0.0658</code></pre>
</div>
<div id="conclusion-1" class="section level3">
<h3>Conclusion</h3>
<p>The nominal significance level α is set to 0.05, the sampled population is (i) χ2(1), (ii) Uniform(0,2), and (iii) Exponential(rate=1), simulation results is 0.0755,0.0512,0.0665.</p>
</div>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<p>If we obtain the powers for two methods under a paticular simulation setting with 10000 experiments:say,0.651 for one method and 0.676 for another method.Can we say the powers are different at 0.05 level? What is the corresponding hypothesis test problem? What test should we use?Z-test,two-sample t-test,paired-t test or McNemar test? What information is needed to test your hypothesis?</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>we cannot say the power are different at 0.05 level, the corresponding hypothesis test is : H0:power1=power2 , H1:power1!=power. I think we should use McNemar test ,because McNemar test is applicable to the multiple constituent comparisons and the correlation analysis of classified data. In this validity test, we can conduct many tests to obtain the validity value of the experiment and the number of times that both methods reject at the same time when the null hypothesis is set.</p>
</div>
<div id="homework-6" class="section level2">
<h2>Homework 6</h2>
</div>
<div id="question-1-2" class="section level2">
<h2>Question 1</h2>
<p>Efron and Tibshirani discuss the scor (bootstrap) test score data on 88 students who took examinations in five subjects [84, Table 7.1], [188, Table 1.2.1]. The first two tests (mechanics, vectors) were closed book and the last three tests (algebra, analysis, statistics) were open book. Each row of the data frame is a set of scores (xi1,… ,xi5)for the ith student. Use a panel display to display the scatter plots for each pair of test scores. Compare the plot with the sample correlation matrix. Obtain bootstrap estimates of the standard errors for each of the following estimates: ˆρ12 =ˆρ(mec, vec), ˆρ34 =ˆρ(alg, ana), ˆρ35 =ˆρ(alg, sta), ˆρ45 =ˆρ(ana, sta).</p>
</div>
<div id="answer-1-2" class="section level2">
<h2>Answer 1</h2>
<div id="the-scatter-plots-for-each-pair-of-test-scores." class="section level3">
<h3>the scatter plots for each pair of test scores.</h3>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="kw">library</span>(boot)</a></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;boot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lattice&#39;:
## 
##     melanoma</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="kw">data</span>(scor,<span class="dt">package=</span><span class="st">&quot;bootstrap&quot;</span>)</a>
<a class="sourceLine" id="cb72-2" title="2"><span class="kw">pairs</span>(<span class="op">~</span>mec<span class="op">+</span>vec<span class="op">+</span>alg<span class="op">+</span>ana<span class="op">+</span>sta,<span class="dt">data=</span>scor,<span class="dt">main=</span><span class="st">&quot;The scatter plot of each pair of test scores&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>plot the sample correlation matrix</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1"><span class="kw">library</span>(corrplot)</a></code></pre></div>
<pre><code>## corrplot 0.84 loaded</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1">res&lt;-<span class="kw">cor</span>(scor, <span class="dt">method =</span> <span class="kw">c</span>(<span class="st">&quot;pearson&quot;</span>, <span class="st">&quot;kendall&quot;</span>, <span class="st">&quot;spearman&quot;</span>))</a>
<a class="sourceLine" id="cb75-2" title="2"><span class="kw">round</span>(res,<span class="dv">3</span>)</a></code></pre></div>
<pre><code>##       mec   vec   alg   ana   sta
## mec 1.000 0.553 0.547 0.409 0.389
## vec 0.553 1.000 0.610 0.485 0.436
## alg 0.547 0.610 1.000 0.711 0.665
## ana 0.409 0.485 0.711 1.000 0.607
## sta 0.389 0.436 0.665 0.607 1.000</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="kw">corrplot</span>(res, <span class="dt">type =</span> <span class="st">&quot;upper&quot;</span>, <span class="dt">order =</span> <span class="st">&quot;hclust&quot;</span>, <span class="dt">tl.col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">tl.srt =</span> <span class="dv">45</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="conclusion-2" class="section level3">
<h3>conclusion</h3>
<p>Compare the plot with the sample correlation matrix, we can know that the sta and alg,sta and ana, alg and ana,alg and vec have strong connections. while the sta and mec, ana and mec have week connections.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="co">#set up the bootstrap </span></a>
<a class="sourceLine" id="cb78-2" title="2"></a>
<a class="sourceLine" id="cb78-3" title="3"><span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb78-4" title="4"><span class="kw">set.seed</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb78-5" title="5">B &lt;-<span class="st"> </span><span class="dv">200</span></a>
<a class="sourceLine" id="cb78-6" title="6"> </a>
<a class="sourceLine" id="cb78-7" title="7">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor)</a>
<a class="sourceLine" id="cb78-8" title="8"><span class="co">#storage for replicates</span></a>
<a class="sourceLine" id="cb78-9" title="9">R &lt;-<span class="st"> </span><span class="kw">numeric</span>(B) </a>
<a class="sourceLine" id="cb78-10" title="10"></a>
<a class="sourceLine" id="cb78-11" title="11"><span class="co">#bootstrap estimate of standard error of R </span></a>
<a class="sourceLine" id="cb78-12" title="12"><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B) { </a>
<a class="sourceLine" id="cb78-13" title="13">  <span class="co">#randomly select the indices </span></a>
<a class="sourceLine" id="cb78-14" title="14">  i &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb78-15" title="15">  mec &lt;-<span class="st"> </span>scor<span class="op">$</span>mec[i]</a>
<a class="sourceLine" id="cb78-16" title="16">  vec &lt;-<span class="st"> </span>scor<span class="op">$</span>vec[i]</a>
<a class="sourceLine" id="cb78-17" title="17">  R[b] &lt;-<span class="st"> </span><span class="kw">cor</span>(mec, vec)</a>
<a class="sourceLine" id="cb78-18" title="18">}</a>
<a class="sourceLine" id="cb78-19" title="19"><span class="co">#output print(</span></a>
<a class="sourceLine" id="cb78-20" title="20">se.R12 &lt;-<span class="st"> </span><span class="kw">sd</span>(R) </a>
<a class="sourceLine" id="cb78-21" title="21">se.R12</a></code></pre></div>
<pre><code>## [1] 0.07494478</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="kw">hist</span>(R, <span class="dt">prob =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1"><span class="co">#set up the bootstrap </span></a>
<a class="sourceLine" id="cb81-2" title="2"></a>
<a class="sourceLine" id="cb81-3" title="3"><span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb81-4" title="4">B &lt;-<span class="st"> </span><span class="dv">200</span></a>
<a class="sourceLine" id="cb81-5" title="5"> </a>
<a class="sourceLine" id="cb81-6" title="6">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor)</a>
<a class="sourceLine" id="cb81-7" title="7"><span class="co">#storage for replicates</span></a>
<a class="sourceLine" id="cb81-8" title="8">R &lt;-<span class="st"> </span><span class="kw">numeric</span>(B) </a>
<a class="sourceLine" id="cb81-9" title="9"></a>
<a class="sourceLine" id="cb81-10" title="10"><span class="co">#bootstrap estimate of standard error of R </span></a>
<a class="sourceLine" id="cb81-11" title="11"><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B) { </a>
<a class="sourceLine" id="cb81-12" title="12">  <span class="co">#randomly select the indices </span></a>
<a class="sourceLine" id="cb81-13" title="13">  i &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb81-14" title="14">  alg &lt;-<span class="st"> </span>scor<span class="op">$</span>alg[i]</a>
<a class="sourceLine" id="cb81-15" title="15">  ana &lt;-<span class="st"> </span>scor<span class="op">$</span>ana[i]</a>
<a class="sourceLine" id="cb81-16" title="16">  R[b] &lt;-<span class="st"> </span><span class="kw">cor</span>(alg, ana)</a>
<a class="sourceLine" id="cb81-17" title="17">}</a>
<a class="sourceLine" id="cb81-18" title="18"><span class="co">#output print(</span></a>
<a class="sourceLine" id="cb81-19" title="19">se.R34 &lt;-<span class="st"> </span><span class="kw">sd</span>(R) </a>
<a class="sourceLine" id="cb81-20" title="20">se.R34</a></code></pre></div>
<pre><code>## [1] 0.04889785</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1"><span class="kw">hist</span>(R, <span class="dt">prob =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="co">#set up the bootstrap </span></a>
<a class="sourceLine" id="cb84-2" title="2"></a>
<a class="sourceLine" id="cb84-3" title="3"><span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb84-4" title="4">B &lt;-<span class="st"> </span><span class="dv">200</span></a>
<a class="sourceLine" id="cb84-5" title="5"> </a>
<a class="sourceLine" id="cb84-6" title="6">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor)</a>
<a class="sourceLine" id="cb84-7" title="7"><span class="co">#storage for replicates</span></a>
<a class="sourceLine" id="cb84-8" title="8">R &lt;-<span class="st"> </span><span class="kw">numeric</span>(B) </a>
<a class="sourceLine" id="cb84-9" title="9"></a>
<a class="sourceLine" id="cb84-10" title="10"><span class="co">#bootstrap estimate of standard error of R </span></a>
<a class="sourceLine" id="cb84-11" title="11"><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B) { </a>
<a class="sourceLine" id="cb84-12" title="12">  <span class="co">#randomly select the indices </span></a>
<a class="sourceLine" id="cb84-13" title="13">  i &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb84-14" title="14">  alg &lt;-<span class="st"> </span>scor<span class="op">$</span>alg[i]</a>
<a class="sourceLine" id="cb84-15" title="15">  sta &lt;-<span class="st"> </span>scor<span class="op">$</span>sta[i]</a>
<a class="sourceLine" id="cb84-16" title="16">  R[b] &lt;-<span class="st"> </span><span class="kw">cor</span>(alg, sta)</a>
<a class="sourceLine" id="cb84-17" title="17">}</a>
<a class="sourceLine" id="cb84-18" title="18"><span class="co">#output print(</span></a>
<a class="sourceLine" id="cb84-19" title="19">se.R35 &lt;-<span class="st"> </span><span class="kw">sd</span>(R) </a>
<a class="sourceLine" id="cb84-20" title="20">se.R35</a></code></pre></div>
<pre><code>## [1] 0.05944714</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="kw">hist</span>(R, <span class="dt">prob =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="co">#set up the bootstrap </span></a>
<a class="sourceLine" id="cb87-2" title="2"></a>
<a class="sourceLine" id="cb87-3" title="3"><span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb87-4" title="4">B &lt;-<span class="st"> </span><span class="dv">200</span></a>
<a class="sourceLine" id="cb87-5" title="5"> </a>
<a class="sourceLine" id="cb87-6" title="6">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor)</a>
<a class="sourceLine" id="cb87-7" title="7"><span class="co">#storage for replicates</span></a>
<a class="sourceLine" id="cb87-8" title="8">R &lt;-<span class="st"> </span><span class="kw">numeric</span>(B) </a>
<a class="sourceLine" id="cb87-9" title="9"></a>
<a class="sourceLine" id="cb87-10" title="10"><span class="co">#bootstrap estimate of standard error of R </span></a>
<a class="sourceLine" id="cb87-11" title="11"><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B) { </a>
<a class="sourceLine" id="cb87-12" title="12">  <span class="co">#randomly select the indices </span></a>
<a class="sourceLine" id="cb87-13" title="13">  i &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb87-14" title="14">  ana&lt;-<span class="st"> </span>scor<span class="op">$</span>ana[i]</a>
<a class="sourceLine" id="cb87-15" title="15">  sta &lt;-<span class="st"> </span>scor<span class="op">$</span>sta[i]</a>
<a class="sourceLine" id="cb87-16" title="16">  R[b] &lt;-<span class="st"> </span><span class="kw">cor</span>(ana, sta)</a>
<a class="sourceLine" id="cb87-17" title="17">}</a>
<a class="sourceLine" id="cb87-18" title="18"><span class="co">#output print(</span></a>
<a class="sourceLine" id="cb87-19" title="19">se.R45 &lt;-<span class="st"> </span><span class="kw">sd</span>(R) </a>
<a class="sourceLine" id="cb87-20" title="20">se.R45</a></code></pre></div>
<pre><code>## [1] 0.07050526</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1"><span class="kw">hist</span>(R, <span class="dt">prob =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb90-2" title="2"><span class="kw">library</span>(kableExtra)</a>
<a class="sourceLine" id="cb90-3" title="3">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">cbind</span>(se.R12,se.R34,se.R35,se.R45),<span class="dt">formate =</span> <span class="st">&quot;html&quot;</span>,<span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;sd of r12&quot;</span>,<span class="st">&quot;sd of r34&quot;</span>,<span class="st">&quot;sd of r35&quot;</span>,<span class="st">&quot;sd of r45&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">position =</span> <span class="st">&quot;center&quot;</span>)</a></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
sd of r12
</th>
<th style="text-align:right;">
sd of r34
</th>
<th style="text-align:right;">
sd of r35
</th>
<th style="text-align:right;">
sd of r45
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.0749448
</td>
<td style="text-align:right;">
0.0488978
</td>
<td style="text-align:right;">
0.0594471
</td>
<td style="text-align:right;">
0.0705053
</td>
</tr>
</tbody>
</table>
</div>
<div id="conclusion-3" class="section level3">
<h3>conclusion</h3>
<p>From the answer,we can know that the sd of R12 is 0.0749448,sd of R34 is 0.0488978,sd of R35 is 0.0594471, sd of R45 is 0.0705053.</p>
</div>
</div>
<div id="question-2-1" class="section level2">
<h2>Question 2</h2>
<p>Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness 0) and χ2(5) distributions (positive skewness).</p>
</div>
<div id="answer-2-1" class="section level2">
<h2>Answer 2</h2>
<div id="normal-populations-skewness-0" class="section level3">
<h3>normal populations (skewness 0)</h3>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1">n&lt;-<span class="fl">1e4</span></a>
<a class="sourceLine" id="cb91-2" title="2"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb91-3" title="3">sk&lt;-<span class="st"> </span><span class="cf">function</span>(x,i) {</a>
<a class="sourceLine" id="cb91-4" title="4">  <span class="co">#computes the sample skewness coeff</span></a>
<a class="sourceLine" id="cb91-5" title="5">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x[i])</a>
<a class="sourceLine" id="cb91-6" title="6">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x[i] <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>) </a>
<a class="sourceLine" id="cb91-7" title="7">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x [i]<span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>) </a>
<a class="sourceLine" id="cb91-8" title="8">  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb91-9" title="9">}</a>
<a class="sourceLine" id="cb91-10" title="10"></a>
<a class="sourceLine" id="cb91-11" title="11">mu&lt;-<span class="dv">0</span>;b&lt;-<span class="dv">1</span>;m&lt;-<span class="fl">1e2</span>;</a>
<a class="sourceLine" id="cb91-12" title="12"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb91-13" title="13"></a>
<a class="sourceLine" id="cb91-14" title="14">ci.norm&lt;-ci.basic&lt;-ci.perc&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb91-15" title="15"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){ </a>
<a class="sourceLine" id="cb91-16" title="16"> U&lt;-<span class="kw">rnorm</span>(m,<span class="dv">0</span>,<span class="dv">1</span>) </a>
<a class="sourceLine" id="cb91-17" title="17">  de &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>U,<span class="dt">statistic=</span>sk, <span class="dt">R =</span> <span class="dv">2000</span>) </a>
<a class="sourceLine" id="cb91-18" title="18">  ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(de ,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb91-19" title="19">  ci.norm[i,]&lt;-ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>];ci.basic[i,]&lt;-ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>] </a>
<a class="sourceLine" id="cb91-20" title="20">  ci.perc[i,]&lt;-ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb91-21" title="21">}</a>
<a class="sourceLine" id="cb91-22" title="22"><span class="kw">cat</span>(<span class="st">&#39;norm =&#39;</span>,<span class="kw">round</span>(<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu <span class="op">&amp;</span><span class="st"> </span>ci.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu),<span class="dv">4</span>), </a>
<a class="sourceLine" id="cb91-23" title="23">    <span class="st">&#39;basic =&#39;</span>,<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu <span class="op">&amp;</span><span class="st"> </span>ci.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu), <span class="st">&#39;perc =&#39;</span>,<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu <span class="op">&amp;</span><span class="st"> </span>ci.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu))</a></code></pre></div>
<pre><code>## norm = 0.92 basic = 0.91 perc = 0.93</code></pre>
</div>
<div id="χ25-distributions-positive-skewness" class="section level3">
<h3>χ2(5) distributions (positive skewness)</h3>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1">n&lt;-<span class="fl">1e4</span></a>
<a class="sourceLine" id="cb93-2" title="2"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb93-3" title="3">sk&lt;-<span class="st"> </span><span class="cf">function</span>(x,i) {</a>
<a class="sourceLine" id="cb93-4" title="4">  <span class="co">#computes the sample skewness coeff</span></a>
<a class="sourceLine" id="cb93-5" title="5">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x[i])</a>
<a class="sourceLine" id="cb93-6" title="6">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x[i] <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>) </a>
<a class="sourceLine" id="cb93-7" title="7">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x [i]<span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>) </a>
<a class="sourceLine" id="cb93-8" title="8">  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb93-9" title="9">}</a>
<a class="sourceLine" id="cb93-10" title="10"></a>
<a class="sourceLine" id="cb93-11" title="11">mu&lt;-<span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>) <span class="co"># skewness of chi-square(5)</span></a>
<a class="sourceLine" id="cb93-12" title="12">b&lt;-<span class="dv">1</span>;m&lt;-<span class="fl">1e2</span>;</a>
<a class="sourceLine" id="cb93-13" title="13"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb93-14" title="14"></a>
<a class="sourceLine" id="cb93-15" title="15">ci.norm&lt;-ci.basic&lt;-ci.perc&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb93-16" title="16"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){ </a>
<a class="sourceLine" id="cb93-17" title="17"> U&lt;-<span class="kw">rchisq</span>(m,<span class="dv">5</span>) </a>
<a class="sourceLine" id="cb93-18" title="18">  de &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>U,<span class="dt">statistic=</span>sk, <span class="dt">R =</span> <span class="dv">2000</span>) </a>
<a class="sourceLine" id="cb93-19" title="19">  ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(de ,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb93-20" title="20">  ci.norm[i,]&lt;-ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>];ci.basic[i,]&lt;-ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>] </a>
<a class="sourceLine" id="cb93-21" title="21">  ci.perc[i,]&lt;-ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb93-22" title="22">}</a>
<a class="sourceLine" id="cb93-23" title="23"><span class="kw">cat</span>(<span class="st">&#39;norm =&#39;</span>,<span class="kw">round</span>(<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu <span class="op">&amp;</span><span class="st"> </span>ci.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu),<span class="dv">4</span>), </a>
<a class="sourceLine" id="cb93-24" title="24">    <span class="st">&#39;basic =&#39;</span>,<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu <span class="op">&amp;</span><span class="st"> </span>ci.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu), <span class="st">&#39;perc =&#39;</span>,<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu <span class="op">&amp;</span><span class="st"> </span>ci.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu))</a></code></pre></div>
<pre><code>## norm = 0.81 basic = 0.78 perc = 0.83</code></pre>
<p>Homework 7 ## Question 1</p>
<p>Efron and Tibshirani discuss the following example. The five-dimensional scores data have a 5 × 5 covariance matrix Σ, with positive eigenvalues λ1 &gt; ··· &gt;λ5. In principal components analysis, <span class="math display">\[\theta=\frac{\lambda_{1}}{\sum_{j=1}^{5} \lambda_{j}}\]</span> measures the proportion of variance explained by the first principal component. Let <span class="math inline">\(\hat{\lambda}_{1}&gt;\cdots&gt;\hat{\lambda}_{5}\)</span> be the eigenvalues of <span class="math inline">\(\hat{\Sigma}\)</span>, where <span class="math inline">\(\hat{\Sigma}\)</span> is the MLE of <span class="math inline">\(\Sigma\)</span>. Compute the sample estimate <span class="math display">\[\hat{\theta}=\frac{\hat{\lambda}_{1}}{\sum_{j=1}^{5} \hat{\lambda}_{j}}\]</span> of θ. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
</div>
<div id="answer-1-3" class="section level2">
<h2>Answer 1</h2>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb95-2" title="2"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb95-3" title="3">n&lt;-<span class="kw">nrow</span>(scor)</a>
<a class="sourceLine" id="cb95-4" title="4">cov.hat&lt;-(n<span class="dv">-1</span>)<span class="op">/</span>n<span class="op">*</span><span class="kw">cov</span>(scor)</a>
<a class="sourceLine" id="cb95-5" title="5">lamda_hat &lt;-<span class="st"> </span><span class="kw">eigen</span>(cov.hat)<span class="op">$</span>values</a>
<a class="sourceLine" id="cb95-6" title="6"><span class="co">## estimate theta_hat</span></a>
<a class="sourceLine" id="cb95-7" title="7">theta_hat &lt;-<span class="st"> </span>lamda_hat[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lamda_hat)</a>
<a class="sourceLine" id="cb95-8" title="8"></a>
<a class="sourceLine" id="cb95-9" title="9">n&lt;-<span class="kw">nrow</span>(scor)</a>
<a class="sourceLine" id="cb95-10" title="10">theta.j&lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb95-11" title="11">ev&lt;-<span class="kw">matrix</span>(<span class="dt">nrow =</span> <span class="dv">88</span>,<span class="dt">ncol =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb95-12" title="12"></a>
<a class="sourceLine" id="cb95-13" title="13"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){ev[i,]&lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(scor[<span class="op">-</span>i,]))<span class="op">$</span>values  </a>
<a class="sourceLine" id="cb95-14" title="14">               theta.j[i]&lt;-ev[i,<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(ev[i,])}</a>
<a class="sourceLine" id="cb95-15" title="15"><span class="co"># estimate bias_jack</span></a>
<a class="sourceLine" id="cb95-16" title="16">bias.jack&lt;-(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.j)<span class="op">-</span>theta_hat)</a>
<a class="sourceLine" id="cb95-17" title="17"></a>
<a class="sourceLine" id="cb95-18" title="18"><span class="co"># estimate se.jack</span></a>
<a class="sourceLine" id="cb95-19" title="19">se.jack&lt;-<span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.j<span class="op">-</span><span class="kw">mean</span>(theta.j))<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb95-20" title="20"></a>
<a class="sourceLine" id="cb95-21" title="21"></a>
<a class="sourceLine" id="cb95-22" title="22"><span class="kw">print</span>(theta_hat)</a></code></pre></div>
<pre><code>## [1] 0.619115</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1"><span class="kw">print</span>(bias.jack)</a></code></pre></div>
<pre><code>## [1] 0.001069139</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"><span class="kw">print</span>(se.jack)</a></code></pre></div>
<pre><code>## [1] 0.04955231</code></pre>
</div>
<div id="question-2-2" class="section level2">
<h2>Question 2</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Repeat the analysis replacing the Log-Log model with a cubic polynomial model. Which of the four models is selected by the cross validation procedure? Which model is selected according to maximum adjusted <span class="math inline">\(R^{2}\)</span>?</p>
</div>
<div id="answer-2-2" class="section level2">
<h2>Answer 2</h2>
<div id="cross-validation-procedure" class="section level3">
<h3>cross validation procedure</h3>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1"><span class="kw">library</span>(DAAG); <span class="kw">attach</span>(ironslag)</a>
<a class="sourceLine" id="cb101-2" title="2"></a>
<a class="sourceLine" id="cb101-3" title="3">a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="fl">.1</span>) <span class="co">#sequence for plotting fits</span></a>
<a class="sourceLine" id="cb101-4" title="4"></a>
<a class="sourceLine" id="cb101-5" title="5">n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag </span></a>
<a class="sourceLine" id="cb101-6" title="6">e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb101-7" title="7"></a>
<a class="sourceLine" id="cb101-8" title="8"><span class="co"># fit models on leave-one-out samples </span></a>
<a class="sourceLine" id="cb101-9" title="9"><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb101-10" title="10">  y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>k] </a>
<a class="sourceLine" id="cb101-11" title="11">  x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb101-12" title="12">  </a>
<a class="sourceLine" id="cb101-13" title="13">  <span class="co"># Linear model</span></a>
<a class="sourceLine" id="cb101-14" title="14">  J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x) </a>
<a class="sourceLine" id="cb101-15" title="15">  yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</a>
<a class="sourceLine" id="cb101-16" title="16">  e1[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1</a>
<a class="sourceLine" id="cb101-17" title="17"></a>
<a class="sourceLine" id="cb101-18" title="18">  <span class="co"># Quadratic model</span></a>
<a class="sourceLine" id="cb101-19" title="19">  J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)) </a>
<a class="sourceLine" id="cb101-20" title="20">  yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb101-21" title="21">  e2[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2</a>
<a class="sourceLine" id="cb101-22" title="22">  </a>
<a class="sourceLine" id="cb101-23" title="23">  <span class="co"># Exponential model</span></a>
<a class="sourceLine" id="cb101-24" title="24">  J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x) </a>
<a class="sourceLine" id="cb101-25" title="25">  logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] </a>
<a class="sourceLine" id="cb101-26" title="26">  yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</a>
<a class="sourceLine" id="cb101-27" title="27">  e3[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3</a>
<a class="sourceLine" id="cb101-28" title="28">  </a>
<a class="sourceLine" id="cb101-29" title="29">  <span class="co"># cubic polynomial model</span></a>
<a class="sourceLine" id="cb101-30" title="30">  J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(y<span class="op">~</span>x<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb101-31" title="31">  yhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span> <span class="op">+</span>J4<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb101-32" title="32">  e4[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4</a>
<a class="sourceLine" id="cb101-33" title="33">}</a>
<a class="sourceLine" id="cb101-34" title="34"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb101-35" title="35">L1 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical) </a>
<a class="sourceLine" id="cb101-36" title="36"><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Linear&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>) </a>
<a class="sourceLine" id="cb101-37" title="37">yhat1 &lt;-<span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a</a>
<a class="sourceLine" id="cb101-38" title="38"><span class="kw">lines</span>(a, yhat1, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1">L2 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>)) </a>
<a class="sourceLine" id="cb102-2" title="2"><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Quadratic&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>) </a>
<a class="sourceLine" id="cb102-3" title="3">yhat2 &lt;-<span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb102-4" title="4"><span class="kw">lines</span>(a, yhat2, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1">L3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span>chemical)</a>
<a class="sourceLine" id="cb103-2" title="2"><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Exponential&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</a>
<a class="sourceLine" id="cb103-3" title="3">logyhat3 &lt;-<span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a </a>
<a class="sourceLine" id="cb103-4" title="4">yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3) </a>
<a class="sourceLine" id="cb103-5" title="5"><span class="kw">lines</span>(a, yhat3, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1">L4 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">3</span>)) </a>
<a class="sourceLine" id="cb104-2" title="2"><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Cubic&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>) </a>
<a class="sourceLine" id="cb104-3" title="3">yhat4 &lt;-<span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span><span class="op">+</span>L4<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb104-4" title="4"><span class="kw">lines</span>(a, yhat2, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAdVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6OgA6OmY6ZpA6ZrY6kLY6kNtmAABmOgBmOjpmkNtmtttmtv+QOgCQOjqQttuQ2/+2ZgC227a229u22/+2///bkDrbtmbb2//b////tmb/25D/27b//7b//9v///8vfDGrAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHfUlEQVR4nO2ca2PcJhBFadq4jd2m79Sp6yTOQ///J1a7sldIi7igAQHDPZ+8w8pCJ2gGhBwzEC+mdAdqh4IAFAQoJejbh5+MMW8e1vF78+q/l6/8ZV5/Orhb1xQS9PVXM/HLqoGCzozX/sKfyxZLUB2UEfRozA/vhuHL6GkcJJOUr29Pw2n8+f1vxtw+zCPodDN+/0eRfg6FBI2XPo2Tb3/ffRxWgibGyLOge/e9eBRFBI0ubqyPK0GvH4YPZvzCJOjJmJ8/fXlb7M4rIujzj4sBsRT03T/PoUnQ1Ph4+2+Jjg41CjoPlcfR01lQ8VJWzy02WbuffNiCbty/5CBKJ+lTuVoK4gga1mX+8Zx3nsxzkj7NjNY56OnNuyIdrWOi+HhSc5I1CXq1rmJ3p3G0nlEeRemlxt1wvrkuc53NedBNmY6WXqxOxfvzqOv2vXcm/XuhfvJxB8IlyHRLqKDE/wjNQEEACgJQEICCABTkZK5eFOTCqu8U5MCeAfll+OdLagkX5I+phYIQzEEIVrFgKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCA/3Jv3w5cX/PDtDsCoh4I8nIYPBXmgID/n/ENBmxgK8jMVMF2CUr5DoHHrOelbFgoFJX0PRePefEpBKl9eSCvo5QdXY2CsOjL40SUoWRUzWgWlwvJMQQ7scUhBDsIF9fmW6+JiOYKuMBTkZ3m3UNCaVTahoBXrdEtBK9bliIKWXJVrClpwPZ+hoAXX8z0KsnHMhynIhoK8OBdUFHTBveLUJQgsqv3N7kZVgsBjB3/zRpMmQeDBjL95q4WCLq0bcUGsNiSCtsUJYtWxPwd5RpYgVh+7q5hn3AlievAVN0GsZqK2GbzVXxCrmLiNGG/iEsTqJW6ryj+/FsTqJUoQWIAIYvUSIwhVPkGsYqIGkL9ZEKuZVH7UCgoFiqQg9AVBTAH4RuxbUECm6l0Q/oog1jwhla5nQUFTgY4FhU2VehUUPNXuVFDEUk0Qa5eIxaxfhtbXgJMJ8sfahYIAMY+LBLFmiXreKIg1S9SOhyDWKlEVp0NBcSW5P0GRU5buBMVO6ToUFPl9QaxFopcEnQmKXzPpEuR+kdf6G2/Xm+Id7aw6J8h20O2nm7155xLUDm756eX1FyRo4wajoOfgVoLqR5A/B21o6CkH+atY/BvAU7Mg1hR7Hxr3Imj3U/VOBO3fdehDkGBXphdB+w8VxJpBsqvXgyDRtqd+QcJtYfWCpNvm2gWJXyzoQxBz0Bbyl1N0C0rw9o5qQScxFLTN5TkQc5CT+Ul051Vs+1Ghp72j94M2biHbj38vCPx6QawKtpLwwo9vLwj9fm9sLpOtCbL2CnMK8seqwH2thoIu+P0wB7kK0jLSexW7JmnGVCgobUXRJyhxxVUnKPWMRJug5DM2ZYLSz2hVCcox49ckKMuKSJGgPAvGBgSFLpryLKjrFxS4bMr1wKF6QYEL72wPZJQIyvfASoegjA/0qhcUkoNyPvCsX1DAfzOW84FwA4IQeR+YHyxIeDHu7QtFgoT7IxuPn/XcYsIdJNfh2XelGhdkKMh3uDHKBCXOQdMnTTkobRV7+aCpim30YdfO3uUL1jd1PlF03iPoxjG2H++bLtLeCWKJeuDKsij1rqRc/mg3vaEmBdlNFOQ+wvVNpYKic9CqQX0Oiq1irtEGD9pPDYJiyDsrdJ1QEAs+B7imiBG0uJ0SnR4cLYiFniJgShOYg+ZYeLoRJqb8gkKmNIFVbOUn6Lqlpc0vw8zsP0MqQRuzH+Hp4fGCWOAZEglafNYkKE0OculSkoOSVDHnGEt0enC0IHYcsmuUnVoQS9YHuzg5m8v5qUHQLCAoGx1MeUFzmdmq7Z2PIK8g+TRMStWCjKGgYTsHPX/qPgdtVTFbW8aTI2oQ5MK4rS2+4G1P1hFBLB924nHfYqg9XVcEsWzYqdmdpFF7wr4IYplY1i4KWp/ofLkU5Ga+WOYg1znsa2UVuzpD2QnhFokF7b5GgZ6WRtDey5SMnpZy0L6KIitDTVWxPZ2VXp9uQQkurilBkfkgzaW1lIMiKkrCf/iWqljgOU3u+yIh+QQ5p7pGJgcdl0F6NkGuxZJ05KCDcwzLeEFhfZhVmCt2dnXfaxBSogUFXma/goarS3b/XpeWXgTZvQnFOkjQWXB4Bj8JkjS0sqpiot4qqmJaOEJQ+AjKMAKkHCAoPAflyCFS8guy8hEoM1mqkBQ4KTTSbqsW5I8FnoGC0CmYg9A5WMXCT1efAcCxgmq8hwCHCqoyCwMoCEBBAOYgAKsYgI87ALGC2hsCQiIFNZhEhMQJarEMCaEgAAUBmIMArGIAzoMAxQS1MhRLCWommRUS1E45pCAABQGYgwCsYgDOgwAUBKAgAAUBKAhAQQAKAlAQoFpBtUwkaxVUzVKkUkH1LGb9MuaXXCloRywjFISoxU+1gljFWoGCABQEoCAABQGCBXVLoKCwxoTHHHdQ/DEUJDmCgihIdgQFUZDsCAqiINkRFERBWc7SFRQEoCAABQEoCEBBAAoCUBCAggD/A8s58VWHtIbgAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>)))</a></code></pre></div>
<pre><code>## [1] 19.55644 17.85248 18.44188 18.17756</code></pre>
</div>
<div id="maximum-adjusted-r2" class="section level3">
<h3>maximum adjusted <span class="math inline">\(R^{2}\)</span></h3>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1"><span class="kw">print</span>(<span class="kw">summary</span>(<span class="kw">lm</span>(L1))<span class="op">$</span>adj.r.squared)</a></code></pre></div>
<pre><code>## [1] 0.5281545</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1"><span class="kw">print</span>(<span class="kw">summary</span>(<span class="kw">lm</span>(L2))<span class="op">$</span>adj.r.squared)</a></code></pre></div>
<pre><code>## [1] 0.5768151</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1"><span class="kw">print</span>(<span class="kw">summary</span>(<span class="kw">lm</span>(L3))<span class="op">$</span>adj.r.squared)</a></code></pre></div>
<pre><code>## [1] 0.5280556</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1"><span class="kw">print</span>(<span class="kw">summary</span>(<span class="kw">lm</span>(L4))<span class="op">$</span>adj.r.squared)</a></code></pre></div>
<pre><code>## [1] 0.5740396</code></pre>
</div>
<div id="conclusion-4" class="section level3">
<h3>Conclusion</h3>
<p>From the answer in cross validation procedure and maximum adjusted <span class="math inline">\(R^{2}\)</span> procedure,we can know that in the first procedure,the Quadratic model has better fitting effect, while in maximum adjusted <span class="math inline">\(R^{2}\)</span> procedure, linear model <span class="math inline">\(R^{2}\)</span> is 0.5281545, Quadratic model <span class="math inline">\(R^{2}\)</span> is 0.5768151, Exponential model <span class="math inline">\(R^{2}\)</span> is 0.5280556, cubic polynomial model <span class="math inline">\(R^{2}\)</span> is 0.5740396, so the Quadratic model has better fitting effect.</p>
<p>Homework 8 ## Question 1</p>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
</div>
<div id="answer-1-4" class="section level2">
<h2>Answer 1</h2>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1"><span class="co"># define the cout 5 test function</span></a>
<a class="sourceLine" id="cb115-2" title="2">count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb115-3" title="3">X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb115-4" title="4">Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb115-5" title="5">outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</a>
<a class="sourceLine" id="cb115-6" title="6">outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</a>
<a class="sourceLine" id="cb115-7" title="7"></a>
<a class="sourceLine" id="cb115-8" title="8"></a>
<a class="sourceLine" id="cb115-9" title="9"><span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb115-10" title="10">}</a>
<a class="sourceLine" id="cb115-11" title="11"></a>
<a class="sourceLine" id="cb115-12" title="12"></a>
<a class="sourceLine" id="cb115-13" title="13">n1&lt;-<span class="dv">20</span> </a>
<a class="sourceLine" id="cb115-14" title="14">n2&lt;-<span class="dv">50</span></a>
<a class="sourceLine" id="cb115-15" title="15">u1&lt;-u2&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb115-16" title="16">sigma1&lt;-sigma2&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb115-17" title="17"></a>
<a class="sourceLine" id="cb115-18" title="18"></a>
<a class="sourceLine" id="cb115-19" title="19">x&lt;-<span class="kw">rnorm</span>(n1,u1,sigma1)</a>
<a class="sourceLine" id="cb115-20" title="20">y&lt;-<span class="kw">rnorm</span>(n2,u2,sigma2)</a>
<a class="sourceLine" id="cb115-21" title="21">z&lt;-<span class="kw">c</span>(x,y)</a>
<a class="sourceLine" id="cb115-22" title="22"><span class="co"># cycle times</span></a>
<a class="sourceLine" id="cb115-23" title="23">R&lt;-<span class="fl">1e4</span></a>
<a class="sourceLine" id="cb115-24" title="24">n&lt;-(n1<span class="op">+</span>n2)<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb115-25" title="25">pool&lt;-<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>(n1<span class="op">+</span>n2))</a>
<a class="sourceLine" id="cb115-26" title="26"><span class="co"># storage of result</span></a>
<a class="sourceLine" id="cb115-27" title="27">temp_result&lt;-<span class="kw">numeric</span>(R)</a>
<a class="sourceLine" id="cb115-28" title="28"><span class="co"># loop</span></a>
<a class="sourceLine" id="cb115-29" title="29"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) {</a>
<a class="sourceLine" id="cb115-30" title="30">  k&lt;-<span class="kw">sample</span>(pool,<span class="dt">size=</span>n,<span class="dt">replace =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb115-31" title="31">  x&lt;-z[k]</a>
<a class="sourceLine" id="cb115-32" title="32">  y&lt;-z[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb115-33" title="33">  temp_result[i]&lt;-<span class="kw">count5test</span>(x,y)</a>
<a class="sourceLine" id="cb115-34" title="34">}</a>
<a class="sourceLine" id="cb115-35" title="35"><span class="co"># show the result</span></a>
<a class="sourceLine" id="cb115-36" title="36">alpha_hat&lt;-<span class="kw">mean</span>(temp_result)</a>
<a class="sourceLine" id="cb115-37" title="37"></a>
<a class="sourceLine" id="cb115-38" title="38"><span class="co"># MC method</span></a>
<a class="sourceLine" id="cb115-39" title="39">mm&lt;-<span class="fl">1e3</span></a>
<a class="sourceLine" id="cb115-40" title="40">MC_method_result&lt;-<span class="kw">numeric</span>(mm)</a>
<a class="sourceLine" id="cb115-41" title="41"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>mm) {</a>
<a class="sourceLine" id="cb115-42" title="42">  xx&lt;-<span class="kw">rnorm</span>(n1,u1,sigma1)</a>
<a class="sourceLine" id="cb115-43" title="43">  yy&lt;-<span class="kw">rnorm</span>(n2,u2,sigma2)</a>
<a class="sourceLine" id="cb115-44" title="44">  zz&lt;-<span class="kw">c</span>(xx,yy)</a>
<a class="sourceLine" id="cb115-45" title="45">  temp_r2&lt;-<span class="kw">numeric</span>(R)</a>
<a class="sourceLine" id="cb115-46" title="46">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) {</a>
<a class="sourceLine" id="cb115-47" title="47">  k&lt;-<span class="kw">sample</span>(pool,<span class="dt">size=</span>n,<span class="dt">replace =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb115-48" title="48">  nx&lt;-zz[k]</a>
<a class="sourceLine" id="cb115-49" title="49">  ny&lt;-zz[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb115-50" title="50">  temp_r2[j]&lt;-<span class="kw">count5test</span>(nx,ny)</a>
<a class="sourceLine" id="cb115-51" title="51">  }</a>
<a class="sourceLine" id="cb115-52" title="52">  MC_method_result[i]&lt;-<span class="kw">mean</span>(temp_r2)</a>
<a class="sourceLine" id="cb115-53" title="53">}</a>
<a class="sourceLine" id="cb115-54" title="54">MC_alpha_hat&lt;-<span class="kw">mean</span>(MC_method_result)</a>
<a class="sourceLine" id="cb115-55" title="55">lable&lt;-<span class="kw">c</span>(<span class="st">&quot; one time&quot;</span>,<span class="st">&quot;permutation in MC method&quot;</span>)</a>
<a class="sourceLine" id="cb115-56" title="56">result&lt;-<span class="kw">c</span>(alpha_hat,MC_alpha_hat)</a>
<a class="sourceLine" id="cb115-57" title="57"><span class="kw">data.frame</span>(lable,result)</a></code></pre></div>
<pre><code>##                      lable    result
## 1                 one time 0.0493000
## 2 permutation in MC method 0.0719338</code></pre>
</div>
<div id="question-2-3" class="section level2">
<h2>Question 2</h2>
<p>Power comparison (distance correlation test versus ballcovariance test) Modle1:<span class="math inline">\(Y=x/4+e\)</span> Modle:<span class="math inline">\(Y=X/4\times\ e\)</span> <span class="math inline">\(X \sim N\left(0_{2}, l_{2}\right), e \sim N\left(0_{2}, l_{2}\right)\)</span></p>
</div>
<div id="answer-2-3" class="section level2">
<h2>Answer 2</h2>
<div id="code" class="section level3">
<h3>Code</h3>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1"><span class="kw">library</span>(Ball)</a>
<a class="sourceLine" id="cb117-2" title="2"><span class="kw">library</span>(mvtnorm)</a>
<a class="sourceLine" id="cb117-3" title="3"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb117-4" title="4"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb117-5" title="5"><span class="co"># distance correlation function</span></a>
<a class="sourceLine" id="cb117-6" title="6">dCov &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb117-7" title="7">  x &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(x); y &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(y)</a>
<a class="sourceLine" id="cb117-8" title="8">  n &lt;-<span class="st"> </span><span class="kw">nrow</span>(x); m &lt;-<span class="st"> </span><span class="kw">nrow</span>(y)</a>
<a class="sourceLine" id="cb117-9" title="9">  <span class="cf">if</span> (n <span class="op">!=</span><span class="st"> </span>m <span class="op">||</span><span class="st"> </span>n <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>) <span class="kw">stop</span>(<span class="st">&quot;Sample sizes must agree&quot;</span>)</a>
<a class="sourceLine" id="cb117-10" title="10">  <span class="cf">if</span> (<span class="op">!</span><span class="st"> </span>(<span class="kw">all</span>(<span class="kw">is.finite</span>(<span class="kw">c</span>(x, y)))))</a>
<a class="sourceLine" id="cb117-11" title="11">  <span class="kw">stop</span>(<span class="st">&quot;Data contains missing or infinite values&quot;</span>)</a>
<a class="sourceLine" id="cb117-12" title="12">  Akl &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb117-13" title="13">  d &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">dist</span>(x))</a>
<a class="sourceLine" id="cb117-14" title="14">  m &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(d); M &lt;-<span class="st"> </span><span class="kw">mean</span>(d)</a>
<a class="sourceLine" id="cb117-15" title="15">  a &lt;-<span class="st"> </span><span class="kw">sweep</span>(d, <span class="dv">1</span>, m); b &lt;-<span class="st"> </span><span class="kw">sweep</span>(a, <span class="dv">2</span>, m)</a>
<a class="sourceLine" id="cb117-16" title="16">  b <span class="op">+</span><span class="st"> </span>M</a>
<a class="sourceLine" id="cb117-17" title="17">  }</a>
<a class="sourceLine" id="cb117-18" title="18">A&lt;-<span class="st"> </span><span class="kw">Akl</span>(x); B &lt;-<span class="st"> </span><span class="kw">Akl</span>(y)</a>
<a class="sourceLine" id="cb117-19" title="19"><span class="kw">sqrt</span>(<span class="kw">mean</span>(A <span class="op">*</span><span class="st"> </span>B))</a>
<a class="sourceLine" id="cb117-20" title="20">}</a>
<a class="sourceLine" id="cb117-21" title="21">ndCov2 &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, dims) {</a>
<a class="sourceLine" id="cb117-22" title="22"><span class="co">#dims contains dimensions of x and y</span></a>
<a class="sourceLine" id="cb117-23" title="23">p &lt;-<span class="st"> </span>dims[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb117-24" title="24">q &lt;-<span class="st"> </span>dims[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb117-25" title="25">d &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span>q</a>
<a class="sourceLine" id="cb117-26" title="26">x &lt;-<span class="st"> </span>z[ , <span class="dv">1</span><span class="op">:</span>p] <span class="co">#leave x as is</span></a>
<a class="sourceLine" id="cb117-27" title="27">y &lt;-<span class="st"> </span>z[ix, <span class="op">-</span>(<span class="dv">1</span><span class="op">:</span>p)] <span class="co">#permute rows of y</span></a>
<a class="sourceLine" id="cb117-28" title="28"><span class="kw">return</span>(<span class="kw">nrow</span>(z) <span class="op">*</span><span class="st"> </span><span class="kw">dCov</span>(x, y)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb117-29" title="29">}</a>
<a class="sourceLine" id="cb117-30" title="30"><span class="co"># generate sample</span></a>
<a class="sourceLine" id="cb117-31" title="31">n&lt;-<span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">10</span>,<span class="dt">to=</span><span class="dv">100</span>,<span class="dt">by=</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb117-32" title="32"><span class="co"># loop</span></a>
<a class="sourceLine" id="cb117-33" title="33">k&lt;-<span class="dv">100</span></a>
<a class="sourceLine" id="cb117-34" title="34"><span class="co"># significant level</span></a>
<a class="sourceLine" id="cb117-35" title="35">alpha&lt;-<span class="fl">0.05</span></a>
<a class="sourceLine" id="cb117-36" title="36">pow_dCor_Model1&lt;-pow_ball_Model1&lt;-pow_dCor_Model2&lt;-pow_ball_Model2&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(n))</a>
<a class="sourceLine" id="cb117-37" title="37"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</a>
<a class="sourceLine" id="cb117-38" title="38"></a>
<a class="sourceLine" id="cb117-39" title="39">  <span class="co">#storage of temp data</span></a>
<a class="sourceLine" id="cb117-40" title="40">  p_ball1&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb117-41" title="41">  dcor1&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb117-42" title="42">  p_ball2&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb117-43" title="43">  dcor2&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb117-44" title="44">  dcor1&lt;-dcor2&lt;-p_ball1&lt;-p_ball2&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb117-45" title="45">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) {</a>
<a class="sourceLine" id="cb117-46" title="46">    <span class="kw">set.seed</span>(i)</a>
<a class="sourceLine" id="cb117-47" title="47">    <span class="co"># the function &quot;rmvnorm&quot; is used to </span></a>
<a class="sourceLine" id="cb117-48" title="48">    <span class="co"># generate the multidimensional normal data</span></a>
<a class="sourceLine" id="cb117-49" title="49">    X&lt;-<span class="kw">rmvnorm</span>(n[j],<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="kw">diag</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb117-50" title="50">    err&lt;-<span class="kw">rmvnorm</span>(n[j],<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="kw">diag</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb117-51" title="51">    Y1&lt;-(X<span class="op">/</span><span class="dv">4</span>)<span class="op">+</span>err</a>
<a class="sourceLine" id="cb117-52" title="52">    Y2&lt;-(X<span class="op">/</span><span class="dv">4</span>)<span class="op">*</span>err</a>
<a class="sourceLine" id="cb117-53" title="53">    Z1&lt;-<span class="kw">cbind</span>(X,Y1)</a>
<a class="sourceLine" id="cb117-54" title="54">    Z2&lt;-<span class="kw">cbind</span>(X,Y2)</a>
<a class="sourceLine" id="cb117-55" title="55">    t1&lt;-<span class="kw">bcov.test</span>(X,Y2,<span class="dt">R=</span><span class="dv">99</span>)</a>
<a class="sourceLine" id="cb117-56" title="56">    p_ball1[i]&lt;-t1<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb117-57" title="57">    boot.obj1&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>Z1,<span class="dt">statistic=</span>ndCov2,<span class="dt">R=</span><span class="dv">99</span>,<span class="dt">sim=</span><span class="st">&quot;permutation&quot;</span>,<span class="dt">dims=</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb117-58" title="58">    temp1&lt;-<span class="kw">c</span>(boot.obj1<span class="op">$</span>t0, boot.obj1<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb117-59" title="59">    dcor1[i]&lt;-<span class="kw">mean</span>(temp1<span class="op">&gt;=</span>temp1[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb117-60" title="60">    </a>
<a class="sourceLine" id="cb117-61" title="61">    t2&lt;-<span class="kw">bcov.test</span>(X,Y2,<span class="dt">R=</span><span class="dv">99</span>)</a>
<a class="sourceLine" id="cb117-62" title="62">    p_ball2[i]&lt;-t2<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb117-63" title="63">    boot.obj2&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>Z2,<span class="dt">statistic=</span>ndCov2,<span class="dt">R=</span><span class="dv">99</span>,<span class="dt">sim=</span><span class="st">&quot;permutation&quot;</span>,<span class="dt">dims=</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb117-64" title="64">    temp2&lt;-<span class="kw">c</span>(boot.obj2<span class="op">$</span>t0, boot.obj2<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb117-65" title="65">    dcor2[i]&lt;-<span class="kw">mean</span>(temp2<span class="op">&gt;=</span>temp2[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb117-66" title="66">    }</a>
<a class="sourceLine" id="cb117-67" title="67">  pow_dCor_Model1[j]&lt;-<span class="kw">mean</span>(dcor1<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb117-68" title="68">  pow_ball_Model1[j]&lt;-<span class="kw">mean</span>(p_ball1<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb117-69" title="69">  pow_dCor_Model2[j]&lt;-<span class="kw">mean</span>(dcor2<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb117-70" title="70">  pow_ball_Model2[j]&lt;-<span class="kw">mean</span>(p_ball2<span class="op">&lt;</span>alpha)  </a>
<a class="sourceLine" id="cb117-71" title="71">}</a>
<a class="sourceLine" id="cb117-72" title="72">dat&lt;-<span class="kw">data.frame</span>(pow_dCor_Model1,pow_ball_Model1,pow_dCor_Model2,pow_ball_Model2)</a>
<a class="sourceLine" id="cb117-73" title="73"></a>
<a class="sourceLine" id="cb117-74" title="74"><span class="kw">ggplot</span>(dat,<span class="kw">aes</span>(n))<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">y=</span>pow_dCor_Model1,<span class="dt">fill=</span><span class="st">&quot;white&quot;</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="dt">y=</span>pow_dCor_Model1,<span class="dt">colour=</span><span class="st">&quot;orange&quot;</span>)<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">y=</span>pow_ball_Model1,<span class="dt">fill=</span><span class="st">&quot;white&quot;</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="dt">y=</span>pow_ball_Model1,<span class="dt">colour=</span><span class="st">&quot;green&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1"><span class="kw">ggplot</span>(dat,<span class="kw">aes</span>(n))<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">y=</span>pow_dCor_Model2,<span class="dt">fill=</span><span class="st">&quot;white&quot;</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="dt">y=</span>pow_dCor_Model2,<span class="dt">colour=</span><span class="st">&quot;orange&quot;</span>)<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">y=</span>pow_ball_Model2,<span class="dt">fill=</span><span class="st">&quot;white&quot;</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="dt">y=</span>pow_ball_Model2,<span class="dt">colour=</span><span class="st">&quot;green&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="code-1" class="section level3">
<h3>Code</h3>
<p>The first plot is the result of model one and the second one is result of model two.The red broken line is distance correlation test and the blue broken line is ballcovariance test.From the plot, we can find that the ballcovariance test is more powerful than distance correlation in the model one and two.</p>
</div>
</div>
<div id="homework-9" class="section level2">
<h2>Homework 9</h2>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1"><span class="kw">set.seed</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb119-2" title="2">lap_fun&lt;-<span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb119-3" title="3">  <span class="kw">return</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x)))</a>
<a class="sourceLine" id="cb119-4" title="4">}</a>
<a class="sourceLine" id="cb119-5" title="5">rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(n, sigma, x0, N) {</a>
<a class="sourceLine" id="cb119-6" title="6">  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb119-7" title="7">  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb119-8" title="8">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb119-9" title="9">  k&lt;-<span class="dv">0</span> </a>
<a class="sourceLine" id="cb119-10" title="10">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb119-11" title="11">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma) </a>
<a class="sourceLine" id="cb119-12" title="12">    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">lap_fun</span>(y)<span class="op">/</span><span class="st"> </span><span class="kw">lap_fun</span>(x[i<span class="dv">-1</span>])))</a>
<a class="sourceLine" id="cb119-13" title="13">      x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span></a>
<a class="sourceLine" id="cb119-14" title="14">        { x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb119-15" title="15">        k&lt;-k<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb119-16" title="16">} }</a>
<a class="sourceLine" id="cb119-17" title="17"><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k)) </a>
<a class="sourceLine" id="cb119-18" title="18">}</a>
<a class="sourceLine" id="cb119-19" title="19"></a>
<a class="sourceLine" id="cb119-20" title="20">N &lt;-<span class="st"> </span><span class="dv">2000</span> </a>
<a class="sourceLine" id="cb119-21" title="21">sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb119-22" title="22">x0 &lt;-<span class="st"> </span><span class="dv">25</span></a>
<a class="sourceLine" id="cb119-23" title="23">rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(n, sigma[<span class="dv">1</span>], x0, N) </a>
<a class="sourceLine" id="cb119-24" title="24">rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(n, sigma[<span class="dv">2</span>], x0, N) </a>
<a class="sourceLine" id="cb119-25" title="25">rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(n, sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb119-26" title="26">rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(n, sigma[<span class="dv">4</span>], x0, N)</a>
<a class="sourceLine" id="cb119-27" title="27"></a>
<a class="sourceLine" id="cb119-28" title="28"><span class="co">#number of candidate points rejected </span></a>
<a class="sourceLine" id="cb119-29" title="29"><span class="kw">print</span>(<span class="kw">c</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k))</a></code></pre></div>
<pre><code>## [1]   46  335  932 1786</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" title="1"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb121-2" title="2"><span class="kw">library</span>(kableExtra)</a>
<a class="sourceLine" id="cb121-3" title="3">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">cbind</span>(<span class="dv">1</span><span class="op">-</span>rw1<span class="op">$</span>k<span class="op">/</span>N,<span class="dv">1</span><span class="op">-</span>rw2<span class="op">$</span>k<span class="op">/</span>N,<span class="dv">1</span><span class="op">-</span>rw3<span class="op">$</span>k<span class="op">/</span>N,<span class="dv">1</span><span class="op">-</span>rw4<span class="op">$</span>k<span class="op">/</span>N),<span class="dt">formate =</span> <span class="st">&quot;html&quot;</span>,<span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;acceptance rates of c1&quot;</span>,<span class="st">&quot;acceptance rates of c2&quot;</span>,<span class="st">&quot;acceptance rates of c3&quot;</span>,<span class="st">&quot;acceptance rates  of c4&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">position =</span> <span class="st">&quot;center&quot;</span>)</a></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
acceptance rates of c1
</th>
<th style="text-align:right;">
acceptance rates of c2
</th>
<th style="text-align:right;">
acceptance rates of c3
</th>
<th style="text-align:right;">
acceptance rates of c4
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.977
</td>
<td style="text-align:right;">
0.8325
</td>
<td style="text-align:right;">
0.534
</td>
<td style="text-align:right;">
0.107
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" title="1"><span class="kw">library</span>(VGAM)</a></code></pre></div>
<pre><code>## 载入需要的程辑包：stats4</code></pre>
<pre><code>## 载入需要的程辑包：splines</code></pre>
<pre><code>## 
## 载入程辑包：&#39;VGAM&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:bootstrap&#39;:
## 
##     hormone</code></pre>
<pre><code>## The following objects are masked from &#39;package:boot&#39;:
## 
##     logit, simplex</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)) </a>
<a class="sourceLine" id="cb128-2" title="2">    refline &lt;-<span class="st"> </span><span class="kw">qlaplace</span>(<span class="kw">c</span>(.<span class="dv">025</span>, <span class="fl">.975</span>))</a>
<a class="sourceLine" id="cb128-3" title="3">    rw &lt;-<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x,  rw4<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb128-4" title="4">    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb128-5" title="5">        <span class="kw">plot</span>(rw[,j], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb128-6" title="6">             <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),</a>
<a class="sourceLine" id="cb128-7" title="7">             <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(rw[,j]))</a>
<a class="sourceLine" id="cb128-8" title="8">        <span class="kw">abline</span>(<span class="dt">h=</span>refline)</a>
<a class="sourceLine" id="cb128-9" title="9">    }</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAABlBMVEUAAAD///+l2Z/dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAG7ElEQVR4nO3diW7rNhCF4Zn3f+miuBE5XI9ELXai/6BA7BHXz7ScNEFrTqaxTy/g2wOQCEAiAIkAJAKQCEAiAIkAJAKQCEAiAIkAJAKQCEAiAIkAJAKQSA/IXpu9QBe/CL8mAIkAJAKQCEAiAIkAJAKQyHGgl1EBJAKQCEAiAIkAJAKQyALQu4QAEgFIBCARgEQAEgFIBCARgEQAEjkM1P9d498NQCLq7dT8ihog7kFFABIBSAQgEYBEABJZ+NUzQACFACQCkAhAIgCJACQCkAhAIgCJACQCkAhAIgCJACQCkAhAIgCJACQCkMgK0KuEFoDedYQAEgFIBCARgEQAEgFIRP2hQu+/EgOQqAEkagCJGkCiBpCoASRqAIkaQKIGkKgBJGoAiRpAogaQqAEkagCJGkCiBpCoASRqAIkaQKIGkKgBJGoAiRpAogaQqAEkagCJGkCiBpCoveqvOAESAUgEIJEVoFfdpQESmWMM/kdtAIkaQKIGkKgBJGoAiRpAogaQqAEkagCJGkCiBpCoASRqAIkaQKIGkKgBJGoAiRpAogaQqAEkagCJGkCiBpCoASRqAIkaQKIGkKgBJGoAiRpAogaQqAEkagCJGkDpEX9hxgkSAUgEIBGARAASAUgEIBGARNaAXiQEkAhAIgCJACQCkAhAIgCJACQCkAhAIktAb/phDCARgEQAEgFIBCARgEQAEgFIBCCR3wf08NwALUwHkJjuASBbHwSgHV3vaHtgiFwb/AkeQKoGkKgBJGofBDr0r3tHbW3/MAAtDHE/kL0R6NDCPwNk+cG3AdUrBWh+EaD6Ugdo8bePFwDZlwKFBhcA7erdO7gdoNlY3w7UNAJIjHoMyHpP///J8mYg72zwaaB5d+s1aoB2YO8Gem3W0M6foP7U7ah1q+07hPMnyK49Qc1TDRS/7fBzQFYWBJBNgOxbgWwItF2xbQ9F8UGg/iu2VrsbyB4HsluB8jvIykbbwo4B2W6g5g6VVhd7x75/Cyh9ikQgU0DWAG1fJFDzQ9E5oLTICqh+Ty8C2QVARfcWKF9OQPLOsQyUV3wYKNjcCGSfANrG7QJt0yegZJKAbLuegLZlZqDi9lAB9bZj4XJs9V1AcfoaKHyPughkp4FCq+3hE0BZqQHKB38XkK0BbQMdBbIAVIx5GZBZWNc+oNTMwr4ikE2Bwg6nQDYEshbILgeyGZAtAtkcyAogy5cSUDo66bBErieAzIZA6fQ2QHYfUIJJw+dVToHCWi10vQkoHOk8VQmUd1ABJZouUHpd84UIZAEoDB4sPC/xYSArgeIrPAYKCxoCJYb0T5r5GJBpoK3N54DylsJO+kBWIKQGPaAweQNUj1Y8i0DWABU3tmWgTFIDxYVUQOVOvFhevYkJUHwltp1uD8JEm0QzWC4/ApQedoCsAYrvtmqzfaBwweu7VLo/jYF6AzVu5dXLgTrb8vCgB5SPVg3UXbsGsgrIO0BeAnWNUsNdGLFPF6hH0tSb+0YBJNrXvf59LbeZPgdyT98DNBSKBCdOkBdTrAK10M1InnpZ+bUAqm9N7eiRcApkw41fD+TVaW6BmnfgEMh6QHYOqH9nuA+o3VzxibptbgrUJHz763HabHkKqPMq3wgUJtze6J7WrIG8u9y8ZwGUUAogr8Z7DMgbIBdA3gfKr2txu8lPErCXr4tHAk+QQ6BwkgNQHC8v7zTQ9qAFii/wjUBeAvnPJ9cRoJ/1Pg+U15h31APyDFRypkN6CMjjnksg9+KETYEOYuwD2ra/ByiN+dPDA5BnIA+tI9A2bwkUFhr2XPKV98IR0FEMBRR2FIF+BDpA9SBjIK++jIHSqMWei5vSACgN96/5LUA+BPIEtG29HCUBuQJKT/4EkMdpCqBqlNjmGJAPgFLj4paigdLd4Bogj0Du7Y6WgIpzVgLlDhWQT4Dyl51AfiFQ3H0PKDZNW68H6bcqgfodIpDXQLGtxfXsAfLPAPUHKVrFxfp9QHFFxTHvr3IVKAy8rWYINOp7BsgPAqXVaqBqmBM19x5Q8246CuRLQKMl924p1uG8DygtYwFoNsERoMnoO4GGy3wAaNh3F9CwdjXQdJS1WqjHu8DTQPOt9T+1PwJUlIYoo0GXgKaTPQz02pxAC/XB55HI/pZbhyMnqO2yMvNVQJdNPu9QzmM7hng10J4hPg3Uufwo0OIkjwNdN/m8w+EeAK1NApCY5KNA+wPQwuTzDgCJDgBd3uNXAx0PQCLfBjT/ofYD+TaglRG/LQCtBCARgC4LQCIAiQAkApAIQCIAiQAkshvotdkJtO/iNMs9PzDlCQOAAJI9AQLoXE+AADrXEyCAzvUE6DaDlwQgEYBEABIBSAQgEYBEABIBSOQ/DJkr3Dv3I6EAAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAABlBMVEUAAAD///+l2Z/dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAFoklEQVR4nO3ajXajKABAYXj/l96zUxVQ5II/1TT37tntKQmCX4zpzjREaxae3sDbEwgSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCKoBha+tF+jiF+FjEggSCBIIEggSCBIIEghqY1R+Xvo2qeErSCCBigSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEgtpA/hqwVxAlECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBDUBvK3XL2CKIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIGgNpC/BuwVRAkECQQJBAkECQR9BVA4sWmBaO7omEAClXNHxwS6EejMRs8k0I3rCkRzR8cEEqicOzomkEDl3NExgQQq546OCSRQOXd0TCCByrmjYwIJVM4dHRNIoHLu6JhAApVzR8cEEqicOzomkEDl3NGx9wLtH1wgOLhAcHCBQvvg9wFd/GvAfw+oMnY70JEFBOqY8xqgw4vlb9TBHfXMeQvQ8UtIIFpKIFhKIFhKIFjqEFDXcmNAQ2cg0Nh2OsYEehVQ3+1DoI45AsGcTwFqbfNpoOmrQNuVi6/3AH1tw2i/eQWFD7qCdh/t/rlFIFj9UaD//3kL0B7EQ0ChF6g+fAfQzlongVpn92agbF//AG4ECmGPoQsoPA8UF6Dabhufm7WVJu2QjXcClc95Dmjzkiag6jF+dJDoDwGtd/wM0L+Dxg1QMe9n4c8Hmm5i8zedQLELaFp77/x2h98FFHeAQkgnWh5yAgphC5Sul+UK2t3bMq1x4r1jvwMUQgUoru/+C1B6ZrwAKF/kV4HiGmj1wZYD1a6gu4HmrbwIqDxkF9AGuBMoFkD1K3xZpRejNrZscLkvpOeMAYVDQDFb4OcFuhiovAkcuYK6gLYHuQIongaa1n83UNgeKakkoPl8QjgFlA6QPfHVQHEDFJJKDjT/6LIGSnfTEmi+OlZAywF6gNafs1cBzTtIQBuifaDifcVA6WsGlF1nC9DC1QE0z78MKCSgZRvT5+kdQAGAsjtOdgVNp/w4UH6X6AIK+VN7gOIgUJh1RoDibUD5myAD2rQGCgNAYQ2UveSjQPWtHQHKj1AFCg2g9VErV9B6oX2guAGKy3gLKFSB4np3R4GqaLlABlS+b4aBlq+jQLECFHKg+BBQdh75LedqoPnRDICBskvnrwCl855J2kDxTqDt3fGlQPEAUHbvTvsaBurF2AFKd+20n/QmuQQoDgDljy8aTwKtTjssJ5E9PAiUH2566BKg5WZFQKEA6saojR0F+nmZZqB0Ea6XCdnX64HmK6uybkj/7caoje0AtSYvD4X661duNOb/XgwUs1nrdeenXw60d7KVY5QfEPVlOoGW8bgFisNA8QOBphlpoe3qAv0BoMb9pHKMi4FiCyh8KhA8JeYnewKo/C4HqpxEWuBDgLIZq3XuBwoCbU8iLbB5QKBygc8Fqq4esj0wUM9WHwUqT373CcWfNVwI1LtDGMCx+4Hyb9tA+R6+AyheAFQ+bxBoe+zhsc8AWj0m0PNAX9sw2skriJ9TPGnkh4j9wx2+fn77LdaTQNDRA169j8Zhe8d+HhCovbxAsLxAsLxAsLxAsLxAty5fW0mgdgJBAkECQZff9c/1PqCXBf9j2vxjka/IKwgSCBIIEggSCBII8q99qE6gvgebXfp3d4/OFEigczMFEujcTIEEOjdTIIHOzRToNoMvSSBIIEggSCBIIEggSCBIIOg/E08xoArORZ0AAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1"> <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#reset to default</span></a>
<a class="sourceLine" id="cb129-2" title="2">    </a>
<a class="sourceLine" id="cb129-3" title="3">    a &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="kw">seq</span>(.<span class="dv">1</span>, <span class="fl">.9</span>, <span class="fl">.1</span>), <span class="fl">.95</span>)</a>
<a class="sourceLine" id="cb129-4" title="4">    Q &lt;-<span class="st"> </span><span class="kw">qlaplace</span>(a, <span class="dv">0</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb129-5" title="5">    rw &lt;-<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x, rw4<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb129-6" title="6">    mc &lt;-<span class="st"> </span>rw[<span class="dv">501</span><span class="op">:</span>N, ]</a>
<a class="sourceLine" id="cb129-7" title="7">    Qrw &lt;-<span class="st"> </span><span class="kw">apply</span>(mc, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="kw">quantile</span>(x, a))</a>
<a class="sourceLine" id="cb129-8" title="8">    qq &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">round</span>(<span class="kw">cbind</span>(Q, Qrw), <span class="dv">3</span>))</a>
<a class="sourceLine" id="cb129-9" title="9">    <span class="kw">names</span>(qq) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;True&#39;</span>,<span class="st">&#39;sigma=0.05&#39;</span>,<span class="st">&#39;sigma=0.5&#39;</span>,<span class="st">&#39;sigma=2&#39;</span>,<span class="st">&#39;sigma=16&#39;</span>)</a>
<a class="sourceLine" id="cb129-10" title="10">    knitr<span class="op">::</span><span class="kw">kable</span>(qq,<span class="dt">format=</span><span class="st">&#39;html&#39;</span>)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">position =</span> <span class="st">&quot;center&quot;</span>)</a></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
True
</th>
<th style="text-align:right;">
sigma=0.05
</th>
<th style="text-align:right;">
sigma=0.5
</th>
<th style="text-align:right;">
sigma=2
</th>
<th style="text-align:right;">
sigma=16
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
5%
</td>
<td style="text-align:right;">
-2.303
</td>
<td style="text-align:right;">
21.786
</td>
<td style="text-align:right;">
-3.050
</td>
<td style="text-align:right;">
-2.222
</td>
<td style="text-align:right;">
-2.307
</td>
</tr>
<tr>
<td style="text-align:left;">
10%
</td>
<td style="text-align:right;">
-1.609
</td>
<td style="text-align:right;">
21.852
</td>
<td style="text-align:right;">
-2.146
</td>
<td style="text-align:right;">
-1.570
</td>
<td style="text-align:right;">
-1.843
</td>
</tr>
<tr>
<td style="text-align:left;">
20%
</td>
<td style="text-align:right;">
-0.916
</td>
<td style="text-align:right;">
22.004
</td>
<td style="text-align:right;">
-1.032
</td>
<td style="text-align:right;">
-0.933
</td>
<td style="text-align:right;">
-0.927
</td>
</tr>
<tr>
<td style="text-align:left;">
30%
</td>
<td style="text-align:right;">
-0.511
</td>
<td style="text-align:right;">
22.243
</td>
<td style="text-align:right;">
-0.446
</td>
<td style="text-align:right;">
-0.581
</td>
<td style="text-align:right;">
-0.358
</td>
</tr>
<tr>
<td style="text-align:left;">
40%
</td>
<td style="text-align:right;">
-0.223
</td>
<td style="text-align:right;">
22.450
</td>
<td style="text-align:right;">
-0.088
</td>
<td style="text-align:right;">
-0.200
</td>
<td style="text-align:right;">
0.100
</td>
</tr>
<tr>
<td style="text-align:left;">
50%
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
22.637
</td>
<td style="text-align:right;">
0.170
</td>
<td style="text-align:right;">
0.033
</td>
<td style="text-align:right;">
0.270
</td>
</tr>
<tr>
<td style="text-align:left;">
60%
</td>
<td style="text-align:right;">
0.223
</td>
<td style="text-align:right;">
22.803
</td>
<td style="text-align:right;">
0.481
</td>
<td style="text-align:right;">
0.338
</td>
<td style="text-align:right;">
0.603
</td>
</tr>
<tr>
<td style="text-align:left;">
70%
</td>
<td style="text-align:right;">
0.511
</td>
<td style="text-align:right;">
23.005
</td>
<td style="text-align:right;">
0.888
</td>
<td style="text-align:right;">
0.558
</td>
<td style="text-align:right;">
1.145
</td>
</tr>
<tr>
<td style="text-align:left;">
80%
</td>
<td style="text-align:right;">
0.916
</td>
<td style="text-align:right;">
23.597
</td>
<td style="text-align:right;">
1.519
</td>
<td style="text-align:right;">
0.985
</td>
<td style="text-align:right;">
1.451
</td>
</tr>
<tr>
<td style="text-align:left;">
90%
</td>
<td style="text-align:right;">
1.609
</td>
<td style="text-align:right;">
24.443
</td>
<td style="text-align:right;">
2.508
</td>
<td style="text-align:right;">
1.770
</td>
<td style="text-align:right;">
1.799
</td>
</tr>
<tr>
<td style="text-align:left;">
95%
</td>
<td style="text-align:right;">
2.303
</td>
<td style="text-align:right;">
24.599
</td>
<td style="text-align:right;">
3.631
</td>
<td style="text-align:right;">
2.611
</td>
<td style="text-align:right;">
2.165
</td>
</tr>
</tbody>
</table>
</div>
<div id="conclusion-5" class="section level2">
<h2>Conclusion</h2>
<p>We can know that when sigma=0.5 and 0.05, the acceptance rate are high relatively, 0.977 and 0.8325 respectively. The Quantiles of the generated samples,sigma is 2 and 16 is similar to True.</p>
<p>Homework 10 # Question 1</p>
<p>The natural logarithm and exponential functions are inverses of each other, so that mathematically log(exp x)=exp(log x)= x. Show by example that this property does not hold exactly in computer arithmetic. Does the identity hold with near equality? (See all.equal.)</p>
</div>
<div id="answer-1-5" class="section level1">
<h1>Answer 1</h1>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" title="1">x1&lt;-<span class="kw">log</span>(<span class="kw">exp</span>(<span class="dv">100</span>))</a>
<a class="sourceLine" id="cb130-2" title="2">y1&lt;-<span class="kw">exp</span>(<span class="kw">log</span>(<span class="dv">100</span>))</a>
<a class="sourceLine" id="cb130-3" title="3">x2&lt;-<span class="kw">log</span>(<span class="kw">exp</span>(<span class="dv">15</span>))</a>
<a class="sourceLine" id="cb130-4" title="4">y2&lt;-<span class="kw">exp</span>(<span class="kw">log</span>(<span class="dv">15</span>))</a>
<a class="sourceLine" id="cb130-5" title="5"></a>
<a class="sourceLine" id="cb130-6" title="6"><span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(x1,y1))</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" title="1"><span class="kw">identical</span>(x1,y1)</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" title="1"><span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(x2,y2))</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" title="1"><span class="kw">identical</span>(x2,y2)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="conclusion-6" class="section level1">
<h1>conclusion</h1>
<p>we can know from the answer ,the natural logarithm and exponential functions does not hold exactly in computer arithmetic. when use all.equal,the answer is true, when uses identical, the answer may diffeerent.</p>
</div>
<div id="question-2-4" class="section level1">
<h1>Question 2</h1>
<p>Write a function to solve the equation</p>
<p><span class="math display">\[
\begin{aligned} \frac{2 \Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1)} \Gamma\left(\frac{k-1}{2}\right)} \int_{0}^{c_{k-1}}\left(1+\frac{u^{2}}{k-1}\right)^{-k / 2} d u \\=&amp; \frac{2 \Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k} \Gamma\left(\frac{k}{2}\right)} \int_{0}^{c_{k}}\left(1+\frac{u^{2}}{k}\right)^{-(k+1) / 2} d u \end{aligned}
\]</span> for <span class="math inline">\(a\)</span>,where</p>
<p><span class="math display">\[
c_{k}=\sqrt{\frac{a^{2} k}{k+1-a^{2}}}
\]</span> Compare the solutions with the points A(k) in Exercise 11.4.</p>
</div>
<div id="answer2-2" class="section level1">
<h1>Answer2</h1>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" title="1"><span class="co"># find the intervals in which the roots fall  </span></a>
<a class="sourceLine" id="cb138-2" title="2">f &lt;-<span class="st"> </span><span class="cf">function</span>(a, k) <span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)), k)</a>
<a class="sourceLine" id="cb138-3" title="3">k &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb138-4" title="4"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb138-5" title="5"><span class="cf">for</span> (i <span class="cf">in</span> k) {</a>
<a class="sourceLine" id="cb138-6" title="6">  g &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">f</span>(x, i<span class="dv">-1</span>)<span class="op">-</span><span class="kw">f</span>(x, i)</a>
<a class="sourceLine" id="cb138-7" title="7">    a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="kw">sqrt</span>(i), <span class="fl">.1</span>)</a>
<a class="sourceLine" id="cb138-8" title="8">  <span class="kw">plot</span>(a, <span class="kw">g</span>(a), <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>, <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&#39;k=&#39;</span>,i))</a>
<a class="sourceLine" id="cb138-9" title="9">  <span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb138-10" title="10">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAZlBMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ZrY6kNtmAABmOgBmZgBmkLZmtttmtv+QOgCQttuQ2/+2ZgC2Zjq2kDq229u22/+2/9u2///bkDrbkGbbtpDb////tmb/25D//7b//9v///+4bi1TAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEc0lEQVR4nO3c2VrTQABA4QEBV0TFBRC1ff+XNLQUWtrMCdlm6TkXkm8WSH7bmlxIWFq0kPoEck8gSCAoAdC3cHoTnT67f/i6uA7h5NPLw9nLDejBYgW0uAoPne8ezl9mQL8/hEeg23DyZXkXwuedw/lLBfTvfTj9+fcirDv5up66bQ4vVkDNq+b88c+twwQlAmout0E5APTmx9UKqAF8t1x/IG0dzn+yiYB+Xa3eMHtAd2/vF2ugZmqtcnqzdTj/ySYC+hhW13wogZor3XrN7CXQGmijsPsWWwq0XAGdfT/8GbR8AjryD+mb5qKby40Arb9s/pnfHCYo1X3Qn7b7vkegh7vDy+cbxcuju1HcOOy1mTj6R43Hj969nuQW1xfPD6sXx/SwWlaHgMLR1hVo5L+EYhIIEggSCBIIEggSCBIIGgx0+FaqnoYDVf7iGgoUInNVJBA0BlDVQgJBA4FCdLaGBIIEggSChgGF6GwVjQNUsZBAkEDQIKAQn64igSCBIIGgkYDqFRoCFGC+igSCBIIEggSCBIIEgsYCqlZoAFCgBVUkECQQJBAkECQQJBAkEDQaUK1CAkECQf2BXo4IBCMCwYhAMCIQjAhEI3UKCQQJBAkECQQJBMUxYr+AQKD4GD+91pFAkECQQJBAkECQQNCYQFUKCQQJBAkECQQJBAkE9QU6aCFQfI1AsEYgWFOlkECQQJBAkECQQJBAkECQQJBAkECQQNC4QBUK9QRqgxAosiQ2Xm4CQQJBAkECQQJBAkECQQJBAkEjA9UnJBAkECQQJBDUD6idQaDWFTRTaAJBAkECQQJBAkFjA1UnJBAkECQQJBAkECQQJBDUCyiGIFDLgi5zJSYQFMdo+QVLUYTKhEZ/BQnUsqDbZHkJBAkECQQJBAkEjQ9UmVAfIBAQSCAYEwjGBIIxgWBMIBgTCMZIoCohgSCBIIEggaAeQHj9AvX4nsUmECQQNAVQVUICQQJBAkECQQJBAkECQQJBAkECQZMA1ST0eqAuFy9Qj+9aaAJBAkECQQJBAkECQQJBAkHTAFUkJBAkECQQJBAkECQQJBAkECQQ9GqgjpdejZBAkECQQJBAkECQQJBA0FRA1QjBXbO9/lFjgDxtaTmfpOUDlJ/NqlyAMuXJBShbngmBXrMjX548gHL2yQEoa58MgPL2SQ+UuU9yoNx9JgTqtCV7n8RA+fukBSrAJylQCT4CUQmBivCZEoj2CBTfU4aPQFQyoEJ8BKJSAZXikwqoGJ9JgSKbBIpvKsdHICoJUEE+AlEpgErymRaoZZdAsEug+K6ifASi5gcqy0cgalqgA9sK8xGImhuoNB+BqImBXu4rzmdmoPJ8BKJmBSrQZ3KgnY0CxTeW6DM90NZOgeI/oUifGYCetgoU/RkZ/3+VaHMANZtL5ZkJqNB316p5gApOIEggSCBIIEggSCBIIKgz0NHWEajb5Kyr052KQAINWy2QQMNWCyTQsNUCCTRstUCjGhxhAkECQQJBAkECQQJBAkECQf8BzFG0S3FR8q0AAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAZlBMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ZrY6kNtmAABmOgBmZgBmkLZmtttmtv+QOgCQttuQ2/+2ZgC2Zjq2kDq229u22/+2/9u2///bkDrbkGbbtpDb////tmb/25D//7b//9v///+4bi1TAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAD3ElEQVR4nO3cbXfSMABA4YAbvos6X9icSv//n7S0wKakvdDmRJre+2HkpDk95BnrCh8IlfUW/vcTuPYEggSCsgJ9DstN7+Gbx93j9i6ExbueYc6uB2gH0ABt12HXbecwa1cD9ONN2APdh8XH6iGED13DrOUH+v06LL/9WoW2xaf20H09XDVA9Uvldv8zPsxbdqB6jzVKBOjF13UDVAO+qtoLUnyY8xnnB/q+bv5KToAeXj5uW6D6UEux3MSHOZ9xfqC3odloLIHq7T17zZwkUAt0UPj7T6wSqGqAbr7Er0HVEWjmF+lNvdN6jz1A7cPhf3tkmLf890E/u2729kC7W8L3T3eHkWHW8gMdHE46HJj9W4399fako9z2bvX0DjU2zJkfd0AxoDDbzgVK/EuYTAJBAkECQQJBAkECQQJBw4Cit09lJhAkECQQNAgozOiaPRBoPkICQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQUOBZiM0BCh0LSoxgSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggaB+jPgXEAgEcwLBXOhcVWACQQJBAkECQQJBA4BC96oCEwgSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIuhwo9KwqMIEggSCBIIEggSCBIIEggSCBoOFAMxESCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCAKMyDdQCeQr6HkCQQJBAkECQQJBI4DmISQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQNAZoFkICQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQRcDBVhYWgJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQfD5s13+oX3/ZOdJp1pioKJsmpIClcczEujf2QJ9BKJSApXokxKoSB+BKIEggaB0QGX6CEQJBCUDKtRHIEogKBVQqT4CUQJB44Din+UXlUCQQJBAkEBQIqBifQSiBIIEgtIAlesjECUQNBJoPy+QQEPmjvMF+whECQQJBAkECQQJBAkEpQAq2UcgSiBIICgBUNE+o4HqAwJ1ze0PCNQ11x4o22c8UOEvoARAhScQJBAkECQQJBAkECQQdDbQbDsT6LyDlyya6Ilw4UT3JVCuE+HCie5LoFwnwoUT3ZdAuU6ECye6L4FynQgXTnRf+YBMIEwgSCBIIEggSCBIIEgg6A/mTKnrX1C1qQAAAABJRU5ErkJggg==" /><!-- --></p>
<p>From the figures plotted when k = 4, 25, 100 and 1000, we can conclude that the roots will fall in the interval (1, 2).</p>
<p>In Exercise 11.4, we can solve the equation when k = 4:25, 100, 500, 1000. The R codes are as follows and the outcomes are listed in a table:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" title="1"><span class="co"># Exercise 11.4</span></a>
<a class="sourceLine" id="cb139-2" title="2">f &lt;-<span class="st"> </span><span class="cf">function</span>(a, k) <span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)), k)</a>
<a class="sourceLine" id="cb139-3" title="3">k &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb139-4" title="4">Ak &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(k))</a>
<a class="sourceLine" id="cb139-5" title="5">i &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb139-6" title="6"><span class="cf">for</span> (j <span class="cf">in</span> k) {</a>
<a class="sourceLine" id="cb139-7" title="7">  g &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">f</span>(x, j<span class="dv">-1</span>)<span class="op">-</span><span class="kw">f</span>(x, j)</a>
<a class="sourceLine" id="cb139-8" title="8">  Ak[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(g, <span class="dt">lower =</span> <span class="dv">1</span>, <span class="dt">upper =</span> <span class="dv">2</span>)<span class="op">$</span>root</a>
<a class="sourceLine" id="cb139-9" title="9">  i &lt;-<span class="st"> </span>i<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb139-10" title="10">}</a>
<a class="sourceLine" id="cb139-11" title="11">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">cbind</span>(k,Ak))</a></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
k
</th>
<th style="text-align:right;">
Ak
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1.492103
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1.533556
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
1.562744
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1.584430
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
1.601185
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
1.614521
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
1.625390
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
1.634419
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
1.642038
</td>
</tr>
<tr>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
1.648554
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
1.654190
</td>
</tr>
<tr>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
1.659114
</td>
</tr>
<tr>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
1.663452
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
1.667304
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
1.670745
</td>
</tr>
<tr>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
1.673840
</td>
</tr>
<tr>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
1.676637
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
1.679178
</td>
</tr>
<tr>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
1.681496
</td>
</tr>
<tr>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
1.683620
</td>
</tr>
<tr>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
1.685572
</td>
</tr>
<tr>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
1.687373
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
1.720608
</td>
</tr>
<tr>
<td style="text-align:right;">
500
</td>
<td style="text-align:right;">
1.729756
</td>
</tr>
<tr>
<td style="text-align:right;">
1000
</td>
<td style="text-align:right;">
1.730908
</td>
</tr>
</tbody>
</table>
<p>Then we turn to Exercise 11.5.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" title="1"><span class="co"># Exercise 11.5</span></a>
<a class="sourceLine" id="cb140-2" title="2">f &lt;-<span class="st"> </span><span class="cf">function</span>(k) <span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(pi<span class="op">*</span>k)<span class="op">*</span><span class="kw">exp</span>(<span class="kw">lgamma</span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb140-3" title="3">ck &lt;-<span class="st"> </span><span class="cf">function</span>(a, k) <span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb140-4" title="4">g &lt;-<span class="st"> </span><span class="cf">function</span>(u, k) (<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>k)<span class="op">^</span>(<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb140-5" title="5">k &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb140-6" title="6">root &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(k))</a>
<a class="sourceLine" id="cb140-7" title="7">i &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb140-8" title="8"><span class="cf">for</span> (j <span class="cf">in</span> k) {</a>
<a class="sourceLine" id="cb140-9" title="9">  ff &lt;-<span class="st"> </span><span class="cf">function</span>(a) <span class="kw">f</span>(j)<span class="op">*</span><span class="kw">integrate</span>(<span class="cf">function</span>(u) {<span class="kw">g</span>(u, j)}, <span class="dv">0</span>, <span class="kw">ck</span>(a, j))<span class="op">$</span>value <span class="op">-</span><span class="st">       </span><span class="kw">f</span>(j<span class="dv">-1</span>)<span class="op">*</span><span class="kw">integrate</span>(<span class="cf">function</span>(u) {<span class="kw">g</span>(u, j<span class="dv">-1</span>)}, <span class="dv">0</span>, <span class="kw">ck</span>(a, j<span class="dv">-1</span>))<span class="op">$</span>value </a>
<a class="sourceLine" id="cb140-10" title="10">  root[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(ff, <span class="dt">lower =</span> <span class="dv">1</span>, <span class="dt">upper =</span> <span class="dv">2</span>)<span class="op">$</span>root</a>
<a class="sourceLine" id="cb140-11" title="11">  i &lt;-<span class="st"> </span>i<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb140-12" title="12">}</a>
<a class="sourceLine" id="cb140-13" title="13">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">cbind</span>(k, Ak, root))</a></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
k
</th>
<th style="text-align:right;">
Ak
</th>
<th style="text-align:right;">
root
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1.492103
</td>
<td style="text-align:right;">
1.492103
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1.533556
</td>
<td style="text-align:right;">
1.533556
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
1.562744
</td>
<td style="text-align:right;">
1.562744
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1.584430
</td>
<td style="text-align:right;">
1.584430
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
1.601185
</td>
<td style="text-align:right;">
1.601185
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
1.614521
</td>
<td style="text-align:right;">
1.614521
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
1.625390
</td>
<td style="text-align:right;">
1.625390
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
1.634419
</td>
<td style="text-align:right;">
1.634419
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
1.642038
</td>
<td style="text-align:right;">
1.642038
</td>
</tr>
<tr>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
1.648554
</td>
<td style="text-align:right;">
1.648554
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
1.654190
</td>
<td style="text-align:right;">
1.654190
</td>
</tr>
<tr>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
1.659114
</td>
<td style="text-align:right;">
1.659114
</td>
</tr>
<tr>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
1.663452
</td>
<td style="text-align:right;">
1.663452
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
1.667304
</td>
<td style="text-align:right;">
1.667304
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
1.670745
</td>
<td style="text-align:right;">
1.670745
</td>
</tr>
<tr>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
1.673840
</td>
<td style="text-align:right;">
1.673840
</td>
</tr>
<tr>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
1.676637
</td>
<td style="text-align:right;">
1.676637
</td>
</tr>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
1.679178
</td>
<td style="text-align:right;">
1.679178
</td>
</tr>
<tr>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
1.681496
</td>
<td style="text-align:right;">
1.681496
</td>
</tr>
<tr>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
1.683620
</td>
<td style="text-align:right;">
1.683620
</td>
</tr>
<tr>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
1.685572
</td>
<td style="text-align:right;">
1.685572
</td>
</tr>
<tr>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
1.687373
</td>
<td style="text-align:right;">
1.687373
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
1.720608
</td>
<td style="text-align:right;">
1.720608
</td>
</tr>
<tr>
<td style="text-align:right;">
500
</td>
<td style="text-align:right;">
1.729756
</td>
<td style="text-align:right;">
1.729756
</td>
</tr>
<tr>
<td style="text-align:right;">
1000
</td>
<td style="text-align:right;">
1.730908
</td>
<td style="text-align:right;">
1.730907
</td>
</tr>
</tbody>
</table>
<p>In the above table, the outcomes in ‘Ak’ column are the outcomes in Exercise 11.4 and these in ‘root’ column are the outcomes in Exercise 11.5. We can see that the results are the same. This result is obvious as these two questions are in fact the same.</p>
</div>
<div id="question-3" class="section level1">
<h1>Question 3</h1>
<ul>
<li>Exercises 11.4 and 11.6 (pages 353-354, Statistical Computing with R)</li>
<li>A-B-O blood type problem
<ul>
<li>Let the three alleles be A, B, and O.</li>
</ul>
<ul>
<li><p>Observed data: <span class="math inline">\(n_{A\cdot}=n_{AA}+n_{AO}=28\)</span> (A-type), <span class="math inline">\(n_{B\cdot}=n_{BB}+n_{BO}=24\)</span> (B-type), <span class="math inline">\(n_{OO}=41\)</span> (O-type), <span class="math inline">\(n_{AB}=70\)</span> (AB-type).</p>
<ul>
<li><p>Use EM algorithm to solve MLE of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> (consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>).</p></li>
<li><p>Record the log-maximum likelihood values in M-steps, are they increasing?</p></li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="answer-3-1" class="section level1">
<h1>Answer 3</h1>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" title="1">nA &lt;-<span class="st"> </span><span class="dv">28</span></a>
<a class="sourceLine" id="cb141-2" title="2">nB &lt;-<span class="st"> </span><span class="dv">24</span></a>
<a class="sourceLine" id="cb141-3" title="3">nOO &lt;-<span class="st"> </span><span class="dv">41</span></a>
<a class="sourceLine" id="cb141-4" title="4">nAB &lt;-<span class="st"> </span><span class="dv">70</span></a>
<a class="sourceLine" id="cb141-5" title="5"><span class="co"># EM algorithm</span></a>
<a class="sourceLine" id="cb141-6" title="6">theta0 &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.3</span>)</a>
<a class="sourceLine" id="cb141-7" title="7">l &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb141-8" title="8"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>) {</a>
<a class="sourceLine" id="cb141-9" title="9">  E &lt;-<span class="st"> </span><span class="cf">function</span>(theta) {</a>
<a class="sourceLine" id="cb141-10" title="10">    p &lt;-<span class="st"> </span>theta[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb141-11" title="11">    q &lt;-<span class="st"> </span>theta[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb141-12" title="12">    r &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q</a>
<a class="sourceLine" id="cb141-13" title="13">    p0 &lt;-<span class="st"> </span>theta0[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb141-14" title="14">    q0 &lt;-<span class="st"> </span>theta0[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb141-15" title="15">    r0 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p0<span class="op">-</span>q0</a>
<a class="sourceLine" id="cb141-16" title="16">    <span class="kw">return</span>(<span class="dv">2</span><span class="op">*</span>nA<span class="op">*</span>(<span class="kw">log</span>(p)<span class="op">+</span>r0<span class="op">/</span>(p0<span class="op">+</span><span class="dv">2</span><span class="op">*</span>r0)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>r<span class="op">/</span>p))<span class="op">+</span><span class="dv">2</span><span class="op">*</span>nB<span class="op">*</span>(<span class="kw">log</span>(q)<span class="op">+</span>r0<span class="op">/</span>(q0<span class="op">+</span><span class="dv">2</span><span class="op">*</span>r0)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>r<span class="op">/</span>q))<span class="op">+</span><span class="dv">2</span><span class="op">*</span>nOO<span class="op">*</span><span class="kw">log</span>(r)<span class="op">+</span>nAB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>q))</a>
<a class="sourceLine" id="cb141-17" title="17">  }</a>
<a class="sourceLine" id="cb141-18" title="18">  Obj &lt;-<span class="st"> </span><span class="cf">function</span>(theta) <span class="op">-</span><span class="kw">E</span>(theta)</a>
<a class="sourceLine" id="cb141-19" title="19">  optim &lt;-<span class="st"> </span><span class="kw">optim</span>(<span class="kw">c</span>(.<span class="dv">1</span>, <span class="fl">.1</span>), Obj)</a>
<a class="sourceLine" id="cb141-20" title="20">  theta0 &lt;-<span class="st"> </span>optim<span class="op">$</span>par</a>
<a class="sourceLine" id="cb141-21" title="21">  l[j] &lt;-<span class="st"> </span><span class="kw">E</span>(theta0)</a>
<a class="sourceLine" id="cb141-22" title="22">}</a>
<a class="sourceLine" id="cb141-23" title="23"><span class="kw">print</span>(theta0)</a></code></pre></div>
<pre><code>## [1] 0.3273325 0.3104528</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" title="1"><span class="kw">plot</span>(l[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>], <span class="dt">type =</span> <span class="st">&#39;o&#39;</span>, <span class="dt">xlab =</span> <span class="st">&#39;iterations&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;log-maximum likelihood values&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>According to EM algorithm, we obtain the MLE of p and q are 0.3273325 and 0.3104528 respectively.<br />
From the line plot of log-maximum likelihood values of 10 iterations, we can see that the values are increasing and converge quickly.</p>
<p>Homework 11 # Question 1</p>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:</p>
<p>formulas &lt;- list(</p>
<p>mpg ~ disp,</p>
<p>mpg ~ I(1 / disp),</p>
<p>mpg ~ disp + wt,</p>
<p>mpg ~ I(1 / disp) + wt )</p>
</div>
<div id="answer-1-6" class="section level1">
<h1>Answer 1</h1>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb144-1" title="1"><span class="co"># attach(mtcars)</span></a>
<a class="sourceLine" id="cb144-2" title="2">data1&lt;-<span class="kw">as.matrix</span>(mtcars)</a>
<a class="sourceLine" id="cb144-3" title="3">mpg&lt;-data1[,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb144-4" title="4">disp&lt;-data1[,<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb144-5" title="5">wt&lt;-data1[,<span class="dv">6</span>]</a>
<a class="sourceLine" id="cb144-6" title="6">formulas &lt;-<span class="st"> </span><span class="kw">list</span>( </a>
<a class="sourceLine" id="cb144-7" title="7">mpg <span class="op">~</span><span class="st"> </span>disp, </a>
<a class="sourceLine" id="cb144-8" title="8">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp), </a>
<a class="sourceLine" id="cb144-9" title="9">mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</a>
<a class="sourceLine" id="cb144-10" title="10">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</a>
<a class="sourceLine" id="cb144-11" title="11">)</a>
<a class="sourceLine" id="cb144-12" title="12"> out&lt;-<span class="kw">list</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb144-13" title="13"> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb144-14" title="14"> out[[i]]&lt;-<span class="kw">lm</span>(formulas[[i]])</a>
<a class="sourceLine" id="cb144-15" title="15"> }</a>
<a class="sourceLine" id="cb144-16" title="16"></a>
<a class="sourceLine" id="cb144-17" title="17"> <span class="kw">unlist</span>(out[[<span class="dv">1</span>]]<span class="op">$</span>coefficients)</a></code></pre></div>
<pre><code>## (Intercept)        disp 
## 29.59985476 -0.04121512</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" title="1"> <span class="kw">unlist</span>(out[[<span class="dv">2</span>]]<span class="op">$</span>coefficients)</a></code></pre></div>
<pre><code>## (Intercept)   I(1/disp) 
##    10.75202  1557.67393</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" title="1"> <span class="kw">unlist</span>(out[[<span class="dv">3</span>]]<span class="op">$</span>coefficients)</a></code></pre></div>
<pre><code>## (Intercept)        disp          wt 
## 34.96055404 -0.01772474 -3.35082533</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" title="1">  <span class="kw">unlist</span>(out[[<span class="dv">4</span>]]<span class="op">$</span>coefficients)</a></code></pre></div>
<pre><code>## (Intercept)   I(1/disp)          wt 
##   19.024206 1142.559975   -1.797649</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" title="1"><span class="co">#lapply</span></a>
<a class="sourceLine" id="cb152-2" title="2"><span class="kw">lapply</span>(formulas,lm)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="question-2-5" class="section level1">
<h1>Question 2</h1>
<p>Fit the model mpg ~ disp to each of the bootstrap replicates of mtcars in the list below by using a for loop and lapply(). Can you do it without an anonymous function? bootstraps &lt;- lapply(1:10, function(i) { rows &lt;- sample(1:nrow(mtcars), rep = TRUE) mtcars[rows, ] })</p>
</div>
<div id="answer-2-4" class="section level1">
<h1>Answer 2</h1>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" title="1"><span class="kw">set.seed</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb154-2" title="2"><span class="co"># for loops</span></a>
<a class="sourceLine" id="cb154-3" title="3">bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb154-4" title="4">rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb154-5" title="5">mtcars[rows, ]</a>
<a class="sourceLine" id="cb154-6" title="6">})</a>
<a class="sourceLine" id="cb154-7" title="7">out2&lt;-<span class="kw">list</span>()</a>
<a class="sourceLine" id="cb154-8" title="8">c</a></code></pre></div>
<pre><code>##              c1         c2
## [1,] -0.1556104 -0.1518182
## [2,] -0.1303459 -0.1274098
## [3,]  0.1214173  0.1274098
## [4,]  0.1300384  0.1518182</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" title="1"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){</a>
<a class="sourceLine" id="cb156-2" title="2">        out2[i]&lt;-<span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>disp,bootstraps[i])</a>
<a class="sourceLine" id="cb156-3" title="3">        <span class="co">#c[i]&lt;-out[[i]]$coefficients</span></a>
<a class="sourceLine" id="cb156-4" title="4">}</a>
<a class="sourceLine" id="cb156-5" title="5">out2</a></code></pre></div>
<pre><code>## [[1]]
## (Intercept)        disp 
## 29.59985476 -0.04121512 
## 
## [[2]]
## (Intercept)        disp 
## 29.59985476 -0.04121512 
## 
## [[3]]
## (Intercept)        disp 
## 29.59985476 -0.04121512 
## 
## [[4]]
## (Intercept)        disp 
## 29.59985476 -0.04121512 
## 
## [[5]]
## (Intercept)        disp 
## 29.59985476 -0.04121512 
## 
## [[6]]
## (Intercept)        disp 
## 29.59985476 -0.04121512 
## 
## [[7]]
## (Intercept)        disp 
## 29.59985476 -0.04121512 
## 
## [[8]]
## (Intercept)        disp 
## 29.59985476 -0.04121512 
## 
## [[9]]
## (Intercept)        disp 
## 29.59985476 -0.04121512 
## 
## [[10]]
## (Intercept)        disp 
## 29.59985476 -0.04121512</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" title="1"><span class="kw">lapply</span>(bootstraps,lm,<span class="dt">formula=</span>mpg <span class="op">~</span><span class="st"> </span>disp)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    26.66841     -0.03051  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.19074     -0.04154  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.40014     -0.04445  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.44286     -0.04566  
## 
## 
## [[5]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.34661     -0.04429  
## 
## 
## [[6]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.72026     -0.04563  
## 
## 
## [[7]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.57421     -0.04612  
## 
## 
## [[8]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.60093     -0.03704  
## 
## 
## [[9]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.50750     -0.03559  
## 
## 
## [[10]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.64187     -0.03027</code></pre>
</div>
<div id="question-3-1" class="section level1">
<h1>Question 3</h1>
<p>For each model in the previous two exercises, extract R2 using the function below. rsq &lt;- function(mod) summary(mod)$r.squared</p>
</div>
<div id="answer-3-2" class="section level1">
<h1>Answer 3</h1>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb160-1" title="1">rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb160-2" title="2">a&lt;-<span class="kw">lapply</span>(formulas,lm)</a>
<a class="sourceLine" id="cb160-3" title="3"><span class="kw">lapply</span>(a,rsq)</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" title="1">b&lt;-<span class="kw">lapply</span>(bootstraps,lm,<span class="dt">formula=</span>mpg <span class="op">~</span><span class="st"> </span>disp)</a>
<a class="sourceLine" id="cb162-2" title="2"><span class="kw">lapply</span>(b,rsq)</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.5570039
## 
## [[2]]
## [1] 0.6558963
## 
## [[3]]
## [1] 0.7000628
## 
## [[4]]
## [1] 0.7995445
## 
## [[5]]
## [1] 0.8215032
## 
## [[6]]
## [1] 0.7983167
## 
## [[7]]
## [1] 0.8143575
## 
## [[8]]
## [1] 0.67799
## 
## [[9]]
## [1] 0.62433
## 
## [[10]]
## [1] 0.6179178</code></pre>
</div>
<div id="question-4" class="section level1">
<h1>Question 4</h1>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial. trials &lt;- replicate( 100, t.test(rpois(10, 10), rpois(7, 10)), simplify = FALSE )</p>
</div>
<div id="answer-4" class="section level1">
<h1>Answer 4</h1>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb164-1" title="1">trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</a>
<a class="sourceLine" id="cb164-2" title="2"><span class="dv">100</span>, </a>
<a class="sourceLine" id="cb164-3" title="3"><span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</a>
<a class="sourceLine" id="cb164-4" title="4"><span class="dt">simplify =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb164-5" title="5">)</a>
<a class="sourceLine" id="cb164-6" title="6">c&lt;-<span class="kw">list</span>()</a>
<a class="sourceLine" id="cb164-7" title="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>){</a>
<a class="sourceLine" id="cb164-8" title="8">        c[i]&lt;-trials[[i]]<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb164-9" title="9">}</a>
<a class="sourceLine" id="cb164-10" title="10">df&lt;-<span class="kw">data.frame</span>(<span class="dt">x=</span><span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,<span class="dt">y=</span>c)</a>
<a class="sourceLine" id="cb164-11" title="11"><span class="kw">sapply</span>(df,class, <span class="dt">simplify =</span> <span class="st">&quot;array&quot;</span>, <span class="dt">USE.NAMES =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>##                     x   y.0.931137419307974   y.0.249194189956778 
##             &quot;integer&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.797097250646078   y.0.329750565557177   y.0.669767431309985 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.771214249650425   y.0.992688386437346   y.0.348215085413048 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.227659454460614   y.0.752757857612283   y.0.755327417788399 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.251961450121717   y.0.446243464951836   y.0.571648380764535 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.819055966558168   y.0.697971704047594   y.0.750921363744505 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.905355099865552   y.0.605443952309239   y.0.737624493491084 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
## y.0.00445453025683192  y.0.0793947263957575   y.0.334227430919514 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.728065620319157   y.0.630898707254709   y.0.777507620946494 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.237555643574063  y.0.0390105589740493  y.0.0353852436224471 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.236768491582416   y.0.308090977906511   y.0.961790212817147 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.419910135399949   y.0.306714162098913   y.0.705983891070387 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.737567433345658   y.0.305454058478725   y.0.393976638480546 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##  y.0.0132705100708275   y.0.993139997881529    y.0.15471863899738 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##  y.0.0908150407236527   y.0.922069034687322  y.0.0558616758842522 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.608927757651301   y.0.653421400483534   y.0.150598221368617 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.594313749329377   y.0.822834725729877   y.0.993130817569633 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.820101965446567   y.0.196430920808759     y.0.1971853741175 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.387829824980476  y.0.0694382900574917   y.0.370303895249472 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.361310081950526   y.0.557608016460694   y.0.348985631840966 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.245608869199436   y.0.757541065081882 y.0.00301577832133577 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.205722827872589   y.0.604864070897237   y.0.906974079362902 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.554576397018735  y.0.0491337114135139   y.0.300097941508174 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.518304600256361   y.0.658501621875221   y.0.136545388327024 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.925942174455271   y.0.548648009306976   y.0.614415923342781 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
## y.0.00287839546465579  y.0.0107211169687374   y.0.584114193149212 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.843374850013378   y.0.462478010539557    y.0.90650720863711 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.082785081102618  y.0.0960576561906623   y.0.737631704023234 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.396833299227009   y.0.529889215345874   y.0.454955234485668 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.669909366050665   y.0.136655613460518   y.0.656101287393733 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.154566446692299   y.0.467475950799018   y.0.274787391636346 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.278480365374119   y.0.811913405156445   y.0.954213913872788 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.380640397141803   y.0.903140232738904   y.0.831590744760448 
##             &quot;numeric&quot;             &quot;numeric&quot;             &quot;numeric&quot; 
##   y.0.354792915391048   y.0.767057029445852 
##             &quot;numeric&quot;             &quot;numeric&quot;</code></pre>
</div>
<div id="question-5" class="section level1">
<h1>Question 5</h1>
<p>Implement mcsapply(), a multicore version of sapply(). Can you implement mcvapply(), a parallel version of vapply()? Why or why not?</p>
</div>
<div id="answer-5" class="section level1">
<h1>Answer 5</h1>
</div>
<div id="answer-5-1" class="section level1">
<h1>Answer 5</h1>
<p><span class="math inline">\(mcsapply()\)</span> is just ‘unlist(<span class="math inline">\(*\)</span>)’, where <span class="math inline">\(*\)</span> is the outcome of <span class="math inline">\(mclapply()\)</span>. We implement it as follows.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb166-1" title="1"><span class="co"># mcsapply()</span></a>
<a class="sourceLine" id="cb166-2" title="2"><span class="kw">library</span>(parallel)</a>
<a class="sourceLine" id="cb166-3" title="3">boot_df &lt;-<span class="st"> </span><span class="cf">function</span>(x) x[<span class="kw">sample</span>(<span class="kw">nrow</span>(x), <span class="dt">rep =</span> T), ]</a>
<a class="sourceLine" id="cb166-4" title="4">rsquared &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb166-5" title="5">boot_lm &lt;-<span class="st"> </span><span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb166-6" title="6">  <span class="kw">rsquared</span>(<span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>wt <span class="op">+</span><span class="st"> </span>disp, <span class="dt">data =</span> <span class="kw">boot_df</span>(mtcars)))</a>
<a class="sourceLine" id="cb166-7" title="7">}</a>
<a class="sourceLine" id="cb166-8" title="8"><span class="kw">system.time</span>(<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="fl">1e5</span>, boot_lm))</a>
<a class="sourceLine" id="cb166-9" title="9"><span class="kw">system.time</span>(<span class="kw">unlist</span>(<span class="kw">mclapply</span>(<span class="dv">1</span><span class="op">:</span><span class="fl">1e5</span>, boot_lm, <span class="dt">mc.cores =</span> <span class="dv">4</span>)))</a></code></pre></div>
<p>In Windows, <span class="math inline">\(mclapply()\)</span> fails and we run the R codes on Linux. The outcomes are in the following picture.</p>
<p>Homework 12 ### Question &gt;You have already written an R function for Exercise 9.4 (page 277, Statistical Computing with R).(1)Rewrite an Rcpp function for the same task.(2)Compare the generated random numbers by the two functions using qqplot.(3)Campare the computation time of the two functions with microbenchmark.(4)Comments your results.</p>
<div id="answer-6" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb167-1" title="1"><span class="co">#the function written before</span></a>
<a class="sourceLine" id="cb167-2" title="2"><span class="kw">library</span>(kableExtra)</a>
<a class="sourceLine" id="cb167-3" title="3"><span class="kw">library</span>(GeneralizedHyperbolic)</a>
<a class="sourceLine" id="cb167-4" title="4">rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma,x0,N) {</a>
<a class="sourceLine" id="cb167-5" title="5">x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb167-6" title="6">x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb167-7" title="7">u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb167-8" title="8">k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb167-9" title="9"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb167-10" title="10">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb167-11" title="11"><span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">abs</span>(x[i<span class="dv">-1</span>]) <span class="op">-</span><span class="st"> </span><span class="kw">abs</span>(y))){</a>
<a class="sourceLine" id="cb167-12" title="12">x[i] &lt;-<span class="st"> </span>y </a>
<a class="sourceLine" id="cb167-13" title="13">k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span>}</a>
<a class="sourceLine" id="cb167-14" title="14"><span class="cf">else</span> {</a>
<a class="sourceLine" id="cb167-15" title="15">x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb167-16" title="16"></a>
<a class="sourceLine" id="cb167-17" title="17">} }</a>
<a class="sourceLine" id="cb167-18" title="18"><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb167-19" title="19">}</a>
<a class="sourceLine" id="cb167-20" title="20"></a>
<a class="sourceLine" id="cb167-21" title="21"><span class="co">#the function using Rcpp</span></a>
<a class="sourceLine" id="cb167-22" title="22"><span class="kw">library</span>(Rcpp)</a>
<a class="sourceLine" id="cb167-23" title="23"><span class="kw">cppFunction</span>(<span class="st">&#39;List rw_Metropolis(double sigma, double x0, int N) {</span></a>
<a class="sourceLine" id="cb167-24" title="24"><span class="st">NumericVector x(N);</span></a>
<a class="sourceLine" id="cb167-25" title="25"><span class="st">x[0] = x0;</span></a>
<a class="sourceLine" id="cb167-26" title="26"><span class="st">int k = 0;</span></a>
<a class="sourceLine" id="cb167-27" title="27"><span class="st">for (int i = 1;i &lt; N;i++) {</span></a>
<a class="sourceLine" id="cb167-28" title="28"><span class="st">double u = runif(1)[0];</span></a>
<a class="sourceLine" id="cb167-29" title="29"><span class="st">double y = rnorm(1, x[i-1], sigma)[0];</span></a>
<a class="sourceLine" id="cb167-30" title="30"><span class="st">if (u &lt;= exp(abs(x[i-1]) - abs(y))){</span></a>
<a class="sourceLine" id="cb167-31" title="31"><span class="st">x[i] = y;</span></a>
<a class="sourceLine" id="cb167-32" title="32"><span class="st">k = k + 1;}</span></a>
<a class="sourceLine" id="cb167-33" title="33"><span class="st">else </span></a>
<a class="sourceLine" id="cb167-34" title="34"><span class="st">x[i] = x[i-1];</span></a>
<a class="sourceLine" id="cb167-35" title="35"><span class="st">}</span></a>
<a class="sourceLine" id="cb167-36" title="36"><span class="st">List result = List::create(x,k);</span></a>
<a class="sourceLine" id="cb167-37" title="37"><span class="st">return(result);</span></a>
<a class="sourceLine" id="cb167-38" title="38"><span class="st">}&#39;</span>)</a>
<a class="sourceLine" id="cb167-39" title="39"></a>
<a class="sourceLine" id="cb167-40" title="40"><span class="co">#generate random samples</span></a>
<a class="sourceLine" id="cb167-41" title="41"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb167-42" title="42">N &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb167-43" title="43">sigma &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb167-44" title="44">x0 &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb167-45" title="45">sample1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma,x0,N)<span class="op">$</span>x</a>
<a class="sourceLine" id="cb167-46" title="46">sample2 &lt;-<span class="st"> </span><span class="kw">rw_Metropolis</span>(sigma,x0,N)[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb167-47" title="47"></a>
<a class="sourceLine" id="cb167-48" title="48"><span class="co">#qq plot</span></a>
<a class="sourceLine" id="cb167-49" title="49"><span class="kw">library</span>(car)</a></code></pre></div>
<pre><code>## 载入需要的程辑包：carData</code></pre>
<pre><code>## 
## 载入程辑包：&#39;car&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:VGAM&#39;:
## 
##     logit</code></pre>
<pre><code>## The following object is masked from &#39;package:DAAG&#39;:
## 
##     vif</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     logit</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb173-1" title="1"><span class="kw">qqplot</span>(sample1, sample2, <span class="dt">xlab =</span> <span class="st">&quot;the samples using R&quot;</span>,</a>
<a class="sourceLine" id="cb173-2" title="2">       <span class="dt">ylab =</span> <span class="st">&quot;the samples using Rcpp&quot;</span>)</a>
<a class="sourceLine" id="cb173-3" title="3">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">4</span>,.<span class="dv">01</span>)</a>
<a class="sourceLine" id="cb173-4" title="4"><span class="kw">lines</span>(x,x,<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb174-1" title="1"><span class="co">#Campare the computation time</span></a>
<a class="sourceLine" id="cb174-2" title="2"><span class="kw">library</span>(microbenchmark)</a>
<a class="sourceLine" id="cb174-3" title="3">ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">rw1 =</span> <span class="kw">rw.Metropolis</span>(sigma,x0,N),<span class="dt">rw2 =</span> <span class="kw">rw_Metropolis</span>(sigma,x0,N))</a>
<a class="sourceLine" id="cb174-4" title="4"><span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</a></code></pre></div>
<pre><code>##   expr      lq  median      uq
## 1  rw1 2422.55 2464.35 2560.95
## 2  rw2  154.80  157.80  163.45</code></pre>
<p>##Conclusion We can see that the qq plot is close to y = x,which means the samples generated by two samplers are quite similar.By computing the computation time,the time of sampler using R is much more than that of sampler using Rcpp,so Rcpp gives higher performance computation.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
